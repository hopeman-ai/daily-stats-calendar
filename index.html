<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏöîÏ¶ò Ïñ¥Îïå?</title>

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="ÏöîÏ¶ò Ïñ¥Îïå?" />
    <meta property="og:description" content="ÎÇòÎ•º Î≥¥Îäî Ï∫òÎ¶∞Îçî" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://hopeman-ai.github.io/daily-stats-calendar/" />
    <meta property="og:image" content="https://hopeman-ai.github.io/daily-stats-calendar/now-icon.png" />
    <meta name="description" content="ÏöîÏ¶ò Ïñ¥Îïå? - ÎÇòÎ•º Î≥¥Îäî Ï∫òÎ¶∞Îçî" />

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 10px;
        }

        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
            line-height: 1.2;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5em;
        }

        .title-icon {
            width: 1.45em;
            height: 1.45em;
            flex-shrink: 0;
            object-fit: contain;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 8px 15px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            color: #666;
            transition: all 0.3s;
        }

        .tab.active {
            color: #4CAF50;
            border-bottom: 3px solid #4CAF50;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* Ìôà ÌÉúÍ∑∏ÎùºÏù∏ */
        .home-tagline {
            text-align: center;
            color: #b0b0b0;
            font-size: 13px;
            font-weight: 400;
            letter-spacing: 0.02em;
            margin: 0 0 20px 0;
            padding: 0;
            line-height: 1.6;
        }

        /* Ï∫òÎ¶∞Îçî Ïä§ÌÉÄÏùº */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .calendar-header button {
            padding: 6px 10px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
        }

        .calendar-header button:hover {
            background: #45a049;
        }

        .calendar-header h2 {
            color: #333;
            font-size: 1.1rem;
            text-align: center;
            flex: 1;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            width: 100%;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: bold;
            padding: 5px 2px;
            color: #666;
            font-size: 11px;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            padding: 4px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .calendar-day:hover {
            background: #f0f0f0;
            transform: scale(1.05);
        }

        .calendar-day.empty {
            cursor: default;
            background: #fafafa;
        }

        .calendar-day.empty:hover {
            transform: none;
        }

        .calendar-day.today {
            border: 2px solid #4CAF50;
        }

        .calendar-day.has-data {
            background: #e8f5e9;
        }

        .day-number {
            font-weight: bold;
            margin-bottom: 2px;
            font-size: 11px;
        }

        .day-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 10px;
        }

        /* ÏûÖÎ†• Î™®Îã¨ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .modal-header h2 {
            font-size: 1.2rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .energy-options {
            display: flex;
            gap: 6px;
        }

        .energy-btn {
            flex: 1;
            padding: 10px 4px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
        }

        .energy-btn:hover {
            border-color: #4CAF50;
        }

        .energy-btn.selected {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 14px;
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        .save-btn {
            width: 100%;
            padding: 12px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 15px;
            cursor: pointer;
        }

        .save-btn:hover {
            background: #45a049;
        }

        .delete-btn {
            width: 100%;
            padding: 10px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 5px;
            margin-top: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .delete-btn:hover {
            background: #da190b;
        }

        .help-text {
            font-size: 11px;
            color: #999;
            margin-top: 4px;
        }

        /* ÎßåÎÇ® ÏÑπÏÖò Ïä§ÌÉÄÏùº */
        .meeting-section {
            margin-top: 15px;
            padding: 12px;
            background: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }

        .meeting-toggle {
            cursor: pointer;
            user-select: none;
            font-weight: 500;
            color: #666;
            font-size: 14px;
            list-style: none;
        }

        .meeting-toggle::-webkit-details-marker {
            display: none;
        }

        .meeting-toggle::before {
            content: '‚ñ∂';
            display: inline-block;
            margin-right: 5px;
            transition: transform 0.2s;
            font-size: 10px;
        }

        details[open] .meeting-toggle::before {
            transform: rotate(90deg);
        }

        .meeting-fields {
            margin-top: 12px;
        }

        .meeting-field {
            margin-bottom: 10px;
        }

        .meeting-field:last-child {
            margin-bottom: 0;
        }

        .meeting-field label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            color: #666;
        }

        .meeting-field input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .meeting-field input::placeholder {
            color: #aaa;
        }

        /* Ï∫òÎ¶∞Îçî ÎÇ†Ïßú ÎßåÎÇ® ÏïÑÏù¥ÏΩò */
        .meeting-indicator {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            opacity: 0.5;
        }

        .meeting-count {
            font-size: 8px;
            vertical-align: super;
            margin-left: 1px;
        }

        /* Î≥µÏàò ÎßåÎÇ® UI Ïä§ÌÉÄÏùº */
        .meetings-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .meeting-entry {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            position: relative;
        }

        .meeting-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }

        .meeting-entry-title {
            font-size: 13px;
            font-weight: 600;
            color: #4CAF50;
        }

        .remove-meeting-btn {
            background: #ff5252;
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .remove-meeting-btn:hover {
            background: #d32f2f;
        }

        .add-meeting-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            background: #e8f5e9;
            border: 2px dashed #4CAF50;
            border-radius: 8px;
            color: #4CAF50;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-meeting-btn:hover {
            background: #c8e6c9;
        }

        .meeting-entry .meeting-field {
            margin-bottom: 8px;
        }

        .meeting-entry .meeting-field:last-child {
            margin-bottom: 0;
        }

        .no-meetings-message {
            text-align: center;
            color: #999;
            font-size: 13px;
            padding: 15px;
        }

        /* ÌÜµÍ≥Ñ Ïä§ÌÉÄÏùº */
        .stats-controls {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .period-btn {
            padding: 8px 15px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
        }

        .period-btn.active {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .stats-section {
            margin-bottom: 25px;
        }

        .stats-section h3 {
            color: #333;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .insight {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 8px;
            line-height: 1.5;
            color: #1976d2;
            font-size: 13px;
        }

        .energy-chart {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .energy-bar {
            flex: 1;
            text-align: center;
        }

        .bar {
            height: 150px;
            background: #e0e0e0;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .bar-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: #4CAF50;
            transition: height 0.3s;
        }

        .bar-fill.high {
            background: #4CAF50;
        }

        .bar-fill.medium {
            background: #FFC107;
        }

        .bar-fill.low {
            background: #f44336;
        }

        .bar-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            font-size: 14px;
        }

        .bar-label {
            margin-top: 8px;
            font-weight: bold;
            font-size: 12px;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .tag-item {
            background: #4CAF50;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
        }

        .tag-count {
            background: rgba(255,255,255,0.3);
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 4px;
        }

        /* ÏöîÏïΩ Í≤∞Í≥º Î™®Îã¨ */
        .summary-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
        }

        .summary-modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .summary-content {
            background: white;
            padding: 25px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .summary-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .summary-header h2 {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 5px;
        }

        .summary-header .sub-title {
            font-size: 0.9rem;
            color: #999;
        }

        .summary-text {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            line-height: 1.8;
            font-size: 15px;
            color: #333;
            margin-bottom: 20px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .summary-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .summary-btn {
            flex: 1;
            padding: 12px;
            border: 1px solid #e0e0e0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .summary-btn:hover {
            background: #f5f5f5;
            border-color: #4CAF50;
        }

        .summary-btn.primary {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .summary-btn.primary:hover {
            background: #45a049;
        }

        .summary-close {
            width: 100%;
            padding: 10px;
            background: #e0e0e0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .summary-close:hover {
            background: #d0d0d0;
        }

        .share-canvas {
            display: none;
        }

        .saved-summary {
            margin-top: 15px;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }

        .saved-summary-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .saved-summary-text {
            font-size: 14px;
            color: #333;
            line-height: 1.6;
        }

        /* Ïò§ÎäòÏùò Ìïú Î¨∏Ïû• Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        .saved-summary .summary-btn:hover {
            background: #4CAF50 !important;
            color: white !important;
        }

        .saved-summary .summary-btn:active {
            transform: scale(0.98);
        }

        /* Copyright */
        .copyright {
            text-align: center;
            color: #999;
            font-size: 11px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        /* Îç∞Ïä§ÌÅ¨ÌÜ± ÏµúÏ†ÅÌôî (768px Ïù¥ÏÉÅ) */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }

            .container {
                max-width: 1200px;
                padding: 30px;
            }

            h1 {
                font-size: 2rem;
                margin-bottom: 30px;
                gap: 0.6em;
            }

            .title-icon {
                width: 1.6em;
                height: 1.6em;
            }

            .tabs {
                gap: 10px;
                margin-bottom: 30px;
            }

            .tab {
                padding: 10px 20px;
                font-size: 16px;
            }

            .home-tagline {
                font-size: 15px;
                margin: 0 0 25px 0;
                letter-spacing: 0.03em;
            }

            .calendar-header {
                margin-bottom: 20px;
            }

            .calendar-header button {
                padding: 8px 15px;
                font-size: 14px;
            }

            .calendar-header h2 {
                font-size: 1.5rem;
            }

            .calendar-grid {
                gap: 10px;
            }

            .calendar-day-header {
                padding: 10px;
                font-size: 14px;
            }

            .calendar-day {
                padding: 10px;
                border-radius: 5px;
            }

            .day-number {
                font-size: 14px;
                margin-bottom: 5px;
            }

            .day-indicator {
                font-size: 12px;
                bottom: 5px;
                right: 5px;
            }

            .stats-controls {
                gap: 10px;
                margin-bottom: 30px;
            }

            .period-btn {
                padding: 10px 20px;
                font-size: 14px;
            }

            .stats-section {
                margin-bottom: 30px;
            }

            .stats-section h3 {
                font-size: 1.3rem;
                margin-bottom: 15px;
            }

            .insight {
                padding: 15px;
                font-size: 14px;
                margin-bottom: 10px;
            }

            .energy-chart {
                gap: 20px;
                margin: 20px 0;
            }

            .bar {
                height: 200px;
            }

            .bar-value {
                font-size: 18px;
            }

            .bar-label {
                margin-top: 10px;
                font-size: 14px;
            }

            .tag-list {
                gap: 10px;
                margin-top: 15px;
            }

            .tag-item {
                padding: 8px 15px;
                font-size: 14px;
            }

            .tag-count {
                padding: 2px 8px;
                margin-left: 5px;
            }

            .modal-content {
                padding: 30px;
            }

            .modal-header {
                margin-bottom: 20px;
            }

            .modal-header h2 {
                font-size: 1.5rem;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .energy-options {
                gap: 10px;
            }

            .energy-btn {
                padding: 12px;
                font-size: 14px;
            }

            .save-btn {
                font-size: 16px;
            }

            .delete-btn {
                margin-top: 10px;
            }

            .help-text {
                font-size: 12px;
                margin-top: 5px;
            }

            .summary-content {
                padding: 35px;
            }

            .summary-header h2 {
                font-size: 1.5rem;
            }

            .summary-text {
                padding: 25px;
                font-size: 16px;
            }

            .summary-btn {
                padding: 14px;
                font-size: 15px;
            }

            .saved-summary {
                padding: 18px;
            }

            .saved-summary-label {
                font-size: 13px;
            }

            .saved-summary-text {
                font-size: 15px;
            }

            .copyright {
                font-size: 12px;
                margin-top: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <img src="now-icon.png" alt="Calendar" class="title-icon">
            ÏöîÏ¶ò Ïñ¥Îïå?
        </h1>

        <div class="tabs">
            <button class="tab active" data-view="calendar">Ï∫òÎ¶∞Îçî</button>
            <button class="tab" data-view="stats">ÌÜµÍ≥Ñ</button>
        </div>

        <!-- Ï∫òÎ¶∞Îçî Î∑∞ -->
        <div id="calendar-view" class="view active">
            <p class="home-tagline">ÎÇ†Ïßú ÏúÑÏóê ÎÇ®Îäî Í≤ÉÏùÄ Í∏∞ÏñµÏûÖÎãàÎã§</p>
            <div class="calendar-header">
                <button id="prev-month">‚óÄ Ïù¥Ï†Ñ</button>
                <h2 id="current-month"></h2>
                <button id="next-month">Îã§Ïùå ‚ñ∂</button>
            </div>
            <div class="calendar-grid" id="calendar-grid"></div>
        </div>

        <!-- ÌÜµÍ≥Ñ Î∑∞ -->
        <div id="stats-view" class="view">
            <div class="stats-controls">
                <button class="period-btn active" data-period="7">ÏµúÍ∑º 7Ïùº</button>
                <button class="period-btn" data-period="30">ÏµúÍ∑º 30Ïùº</button>
            </div>
            <div id="stats-content"></div>
        </div>

        <div class="copyright">
            Copyright 2026. Heeseok Choi
        </div>
    </div>

    <!-- ÏûÖÎ†• Î™®Îã¨ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">ÎÇ†Ïßú Í∏∞Î°ù</h2>
                <button class="close-btn" id="close-modal">√ó</button>
            </div>

            <form id="record-form">
                <div class="form-group">
                    <label>ÏóêÎÑàÏßÄ ÏÉÅÌÉú</label>
                    <div class="energy-options">
                        <button type="button" class="energy-btn" data-energy="ÎÜíÏùå">ÎÜíÏùå üî•</button>
                        <button type="button" class="energy-btn" data-energy="Î≥¥ÌÜµ">Î≥¥ÌÜµ ‚ö°</button>
                        <button type="button" class="energy-btn" data-energy="ÎÇÆÏùå">ÎÇÆÏùå üåô</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>ÌïòÎ£® ÌÉúÍ∑∏</label>
                    <input type="text" id="tags-input" placeholder="#ÏßëÏ§ë #Ìú¥Ïãù" />
                    <div class="help-text">#ÏúºÎ°ú ÏãúÏûëÌïòÎäî ÌÉúÍ∑∏Î•º 1~2Í∞ú ÏûÖÎ†•ÌïòÏÑ∏Ïöî</div>
                </div>

                <div class="form-group">
                    <label>Î©îÎ™® (ÏÑ†ÌÉù)</label>
                    <textarea id="memo-input" placeholder="Ïò§Îäò ÌïòÎ£®Î•º Ìïú Ï§ÑÎ°ú Í∏∞Î°ùÌï¥Î≥¥ÏÑ∏Ïöî"></textarea>
                </div>

                <!-- ÎßåÎÇ® Í∏∞Î°ù (ÏÑ†ÌÉù) - Î≥µÏàò ÎßåÎÇ® ÏßÄÏõê -->
                <details class="form-group meeting-section" id="meeting-section">
                    <summary class="meeting-toggle">
                        <span>ÎßåÎÇ® (ÏÑ†ÌÉù)</span>
                    </summary>
                    <div class="meeting-fields">
                        <div id="meetings-container" class="meetings-container">
                            <!-- ÎßåÎÇ® Ìï≠Î™©Îì§Ïù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                        </div>
                        <button type="button" class="add-meeting-btn" id="add-meeting-btn">
                            <span>+</span> ÎßåÎÇ® Ï∂îÍ∞Ä
                        </button>
                    </div>
                </details>

                <button type="submit" class="save-btn">Ï†ÄÏû•</button>
                <button type="button" class="delete-btn" id="delete-btn" style="display:none;">ÏÇ≠Ï†ú</button>
            </form>

            <!-- Ï†ÄÏû•Îêú ÏöîÏïΩ ÌëúÏãú -->
            <div id="saved-summary-container" style="display:none;">
                <div class="saved-summary">
                    <div class="saved-summary-label">Ïò§ÎäòÏùò Ìïú Î¨∏Ïû•</div>
                    <div class="saved-summary-text" id="saved-summary-text"></div>

                    <!-- Î≤ÑÌäº ÏòÅÏó≠ -->
                    <div class="summary-actions" style="display: flex; gap: 8px; margin-top: 15px;">
                        <button type="button" class="summary-btn" id="copy-sentence-btn" style="flex: 1; padding: 10px; border: 1px solid #4CAF50; background: white; color: #4CAF50; border-radius: 5px; cursor: pointer; font-size: 13px; transition: all 0.3s;">üìã Î¨∏Ïû• Î≥µÏÇ¨</button>
                        <button type="button" class="summary-btn" id="share-sentence-btn" style="flex: 1; padding: 10px; border: 1px solid #4CAF50; background: white; color: #4CAF50; border-radius: 5px; cursor: pointer; font-size: 13px; transition: all 0.3s;">üì§ ÏõêÌïòÎ©¥ Í≥µÏú†</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏöîÏïΩ Í≤∞Í≥º Î™®Îã¨ -->
    <div id="summary-modal" class="summary-modal">
        <div class="summary-content">
            <div class="summary-header">
                <h2>Ïò§ÎäòÏùò Ìïú Î¨∏Ïû•</h2>
                <p class="sub-title">Ïò§Îäò ÌïòÎ£®Î•º Ìïú Î¨∏Ïû•ÏúºÎ°ú Ï†ïÎ¶¨ÌñàÏäµÎãàÎã§</p>
            </div>

            <div class="summary-text" id="summary-text"></div>

            <div class="summary-actions">
                <button class="summary-btn" id="copy-summary-btn">üìã Î¨∏Ïû• Î≥µÏÇ¨</button>
                <button class="summary-btn" id="share-summary-btn">üì§ ÏõêÌïòÎ©¥ Í≥µÏú†</button>
            </div>

            <button class="summary-close" id="close-summary-modal">ÌôïÏù∏</button>
        </div>
    </div>

    <!-- Í≥µÏú†Ïö© Ï∫îÎ≤ÑÏä§ (Ïà®ÍπÄ) -->
    <canvas id="share-canvas" class="share-canvas" width="800" height="600"></canvas>

    <script>
        class DailyStatsApp {
            constructor() {
                this.currentDate = new Date();
                this.selectedDate = null;
                this.currentView = 'calendar';
                this.statsPeriod = 7;
                this.init();
            }

            init() {
                // ÌîÑÎùºÏù¥Î≤ÑÏãú Î≥¥Ìò∏: URLÏùÑ ÌÜµÌïú Îç∞Ïù¥ÌÑ∞ Í≥µÏú† Ï∞®Îã®
                this.ensurePrivateData();
                this.loadData();
                this.renderCalendar();
                this.bindEvents();
            }


            ensurePrivateData() {
                // URL ÌååÎùºÎØ∏ÌÑ∞Î•º ÌÜµÌïú Îç∞Ïù¥ÌÑ∞ Ï†ÑÎã¨ Ï∞®Îã®
                // Î™®Îì† Îç∞Ïù¥ÌÑ∞Îäî Î∏åÎùºÏö∞Ï†ÄÏùò localStorageÏóêÎßå Ï†ÄÏû•ÎêòÎ©∞
                // URL Í≥µÏú† ÏãúÏóêÎèÑ Îã§Î•∏ ÏÇ¨Ïö©ÏûêÏóêÍ≤å ÎÖ∏Ï∂úÎêòÏßÄ ÏïäÏùå
                const url = new URL(window.location.href);

                // URLÏóê Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ†® ÌååÎùºÎØ∏ÌÑ∞Í∞Ä ÏûàÏúºÎ©¥ Ï†úÍ±∞
                const dataParams = ['data', 'calendar', 'records', 'import', 'share'];
                let hasDataParam = false;

                dataParams.forEach(param => {
                    if (url.searchParams.has(param)) {
                        url.searchParams.delete(param);
                        hasDataParam = true;
                    }
                });

                // URLÏù¥ ÏàòÏ†ïÎêòÏóàÏúºÎ©¥ ÌÅ¥Î¶∞Ìïú URLÎ°ú ÍµêÏ≤¥
                if (hasDataParam) {
                    window.history.replaceState({}, '', url.pathname + url.search);
                    console.log('[Privacy] Data parameters removed from URL');
                }
            }

            loadData() {
                // Ï§ëÏöî: Î™®Îì† Îç∞Ïù¥ÌÑ∞Îäî Ïù¥ Î∏åÎùºÏö∞Ï†ÄÏùò localStorageÏóêÎßå Ï†ÄÏû•Îê©ÎãàÎã§
                // URLÏùÑ Í≥µÏú†Ìï¥ÎèÑ Îã§Î•∏ ÏÇ¨ÎûåÏóêÍ≤å ÎãπÏã†Ïùò Í∏∞Î°ùÏù¥ Î≥¥Ïù¥ÏßÄ ÏïäÏäµÎãàÎã§
                // localStorageÎäî Î∏åÎùºÏö∞Ï†ÄÎ≥Ñ, ÏÇ¨Ïö©ÏûêÎ≥ÑÎ°ú ÏôÑÏ†ÑÌûà Î∂ÑÎ¶¨ÎêòÏñ¥ ÏûàÏäµÎãàÎã§
                const stored = localStorage.getItem('yozumeottae_calendar_v1');
                this.data = stored ? JSON.parse(stored) : {};
            }

            saveData() {
                // Îç∞Ïù¥ÌÑ∞Îäî Ïò§ÏßÅ Ïù¥ Î∏åÎùºÏö∞Ï†ÄÏùò localStorageÏóêÎßå Ï†ÄÏû•Îê©ÎãàÎã§
                // ÏÑúÎ≤Ñ Ï†ÑÏÜ° ÏóÜÏùå, URL ÎÖ∏Ï∂ú ÏóÜÏùå, ÏôÑÏ†ÑÌïú ÌîÑÎùºÏù¥Î≤ÑÏãú Î≥¥Ïû•
                localStorage.setItem('yozumeottae_calendar_v1', JSON.stringify(this.data));
            }

            // Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò: meeting -> meetings Î∞∞Ïó¥Î°ú Î≥ÄÌôò
            getMeetingsFromRecord(record) {
                if (!record) return [];

                // ÏÉà ÌòïÏãù: meetings Î∞∞Ïó¥
                if (record.meetings && Array.isArray(record.meetings)) {
                    return record.meetings.filter(m => m.time || m.place || m.person);
                }

                // Í∏∞Ï°¥ ÌòïÏãù: Îã®Ïùº meeting Í∞ùÏ≤¥ -> Î∞∞Ïó¥Î°ú Î≥ÄÌôò
                if (record.meeting && (record.meeting.time || record.meeting.place || record.meeting.person)) {
                    return [record.meeting];
                }

                return [];
            }

            // ÎßåÎÇ® Ìï≠Î™© HTML ÏÉùÏÑ±
            createMeetingEntryHTML(index, meeting = {}) {
                return `
                    <div class="meeting-entry" data-meeting-index="${index}">
                        <div class="meeting-entry-header">
                            <span class="meeting-entry-title">ÎßåÎÇ® ${index + 1}</span>
                            <button type="button" class="remove-meeting-btn" data-remove-index="${index}">√ó</button>
                        </div>
                        <div class="meeting-field">
                            <label>ÏãúÍ∞Ñ</label>
                            <input type="text" class="meeting-time-input" placeholder="Ïò§ÌõÑ, Ï†ÄÎÖÅ, 14:00 Îì±" value="${meeting.time || ''}" />
                        </div>
                        <div class="meeting-field">
                            <label>Ïû•ÏÜå</label>
                            <input type="text" class="meeting-place-input" placeholder="Ïó∞Íµ¨Ïã§, Ïπ¥Ìéò Îì±" value="${meeting.place || ''}" />
                        </div>
                        <div class="meeting-field">
                            <label>ÎßåÎÇú ÏÇ¨Îûå</label>
                            <input type="text" class="meeting-person-input" placeholder="ÎèôÎ£å, ÏπúÍµ¨ Îì±" value="${meeting.person || ''}" />
                        </div>
                    </div>
                `;
            }

            // ÎßåÎÇ® Î™©Î°ù Î†åÎçîÎßÅ
            renderMeetings(meetings = []) {
                const container = document.getElementById('meetings-container');

                if (meetings.length === 0) {
                    container.innerHTML = '<div class="no-meetings-message">ÎßåÎÇ® Ï∂îÍ∞Ä Î≤ÑÌäºÏùÑ ÎàåÎü¨ Í∏∞Î°ùÌïòÏÑ∏Ïöî</div>';
                } else {
                    container.innerHTML = meetings.map((m, i) => this.createMeetingEntryHTML(i, m)).join('');
                }

                // ÏÇ≠Ï†ú Î≤ÑÌäº Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
                container.querySelectorAll('.remove-meeting-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.dataset.removeIndex);
                        this.removeMeetingEntry(index);
                    });
                });
            }

            // ÏÉà ÎßåÎÇ® Ï∂îÍ∞Ä
            addMeetingEntry() {
                const container = document.getElementById('meetings-container');
                const currentMeetings = this.collectMeetingsFromForm();
                currentMeetings.push({ time: '', place: '', person: '' });
                this.renderMeetings(currentMeetings);

                // ÎßåÎÇ® ÏÑπÏÖò ÌéºÏπòÍ∏∞
                document.getElementById('meeting-section').open = true;
            }

            // ÎßåÎÇ® ÏÇ≠Ï†ú
            removeMeetingEntry(index) {
                const currentMeetings = this.collectMeetingsFromForm();
                currentMeetings.splice(index, 1);
                this.renderMeetings(currentMeetings);
            }

            // ÌèºÏóêÏÑú ÌòÑÏû¨ ÎßåÎÇ® Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
            collectMeetingsFromForm() {
                const entries = document.querySelectorAll('.meeting-entry');
                const meetings = [];

                entries.forEach(entry => {
                    const time = entry.querySelector('.meeting-time-input').value.trim();
                    const place = entry.querySelector('.meeting-place-input').value.trim();
                    const person = entry.querySelector('.meeting-person-input').value.trim();

                    meetings.push({ time, place, person });
                });

                return meetings;
            }

            getDateKey(date) {
                return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            }

            renderCalendar() {
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();

                document.getElementById('current-month').textContent = `${year}ÎÖÑ ${month + 1}Ïõî`;

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDay = firstDay.getDay();
                const totalDays = lastDay.getDate();

                const grid = document.getElementById('calendar-grid');
                grid.innerHTML = '';

                // ÏöîÏùº Ìó§Îçî
                ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'].forEach(day => {
                    const header = document.createElement('div');
                    header.className = 'calendar-day-header';
                    header.textContent = day;
                    grid.appendChild(header);
                });

                // Îπà Ïπ∏
                for (let i = 0; i < startDay; i++) {
                    const empty = document.createElement('div');
                    empty.className = 'calendar-day empty';
                    grid.appendChild(empty);
                }

                // ÎÇ†Ïßú
                const today = new Date();
                for (let day = 1; day <= totalDays; day++) {
                    const date = new Date(year, month, day);
                    const dateKey = this.getDateKey(date);
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day';

                    if (date.toDateString() === today.toDateString()) {
                        dayEl.classList.add('today');
                    }

                    if (this.data[dateKey]) {
                        dayEl.classList.add('has-data');
                        const indicator = document.createElement('div');
                        indicator.className = 'day-indicator';
                        const energy = this.data[dateKey].energy;
                        indicator.textContent = energy === 'ÎÜíÏùå' ? 'üî•' : energy === 'Î≥¥ÌÜµ' ? '‚ö°' : 'üåô';
                        dayEl.appendChild(indicator);

                        // ÎßåÎÇ® ÏïÑÏù¥ÏΩò ÌëúÏãú (Î≥µÏàò ÎßåÎÇ® ÏßÄÏõê)
                        const record = this.data[dateKey];
                        const meetings = this.getMeetingsFromRecord(record);
                        if (meetings.length > 0) {
                            const meetingIcon = document.createElement('span');
                            meetingIcon.className = 'meeting-indicator';
                            if (meetings.length === 1) {
                                meetingIcon.textContent = 'üë§';
                            } else {
                                meetingIcon.innerHTML = 'üë§<span class="meeting-count">' + meetings.length + '</span>';
                            }
                            dayEl.appendChild(meetingIcon);
                        }
                    }

                    const number = document.createElement('div');
                    number.className = 'day-number';
                    number.textContent = day;
                    dayEl.appendChild(number);

                    dayEl.addEventListener('click', () => this.openModal(date));
                    grid.appendChild(dayEl);
                }
            }

            openModal(date) {
                this.selectedDate = date;
                const dateKey = this.getDateKey(date);
                const record = this.data[dateKey];

                document.getElementById('modal-title').textContent =
                    `${date.getFullYear()}ÎÖÑ ${date.getMonth() + 1}Ïõî ${date.getDate()}Ïùº`;

                // Ìèº Ï¥àÍ∏∞Ìôî
                document.querySelectorAll('.energy-btn').forEach(btn => btn.classList.remove('selected'));
                document.getElementById('tags-input').value = '';
                document.getElementById('memo-input').value = '';

                // ÎßåÎÇ® ÌïÑÎìú Ï¥àÍ∏∞Ìôî
                this.renderMeetings([]);
                document.getElementById('meeting-section').open = false;

                // Ï†ÄÏû•Îêú ÏöîÏïΩ Ï¥àÍ∏∞Ìôî
                const savedSummaryContainer = document.getElementById('saved-summary-container');
                savedSummaryContainer.style.display = 'none';

                // Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                if (record) {
                    const energyBtn = document.querySelector(`[data-energy="${record.energy}"]`);
                    if (energyBtn) energyBtn.classList.add('selected');
                    document.getElementById('tags-input').value = record.tags.join(' ');
                    document.getElementById('memo-input').value = record.memo || '';
                    document.getElementById('delete-btn').style.display = 'block';

                    // Ï†ÄÏû•Îêú ÏöîÏïΩ ÌëúÏãú
                    if (record.summary) {
                        document.getElementById('saved-summary-text').textContent = record.summary;
                        savedSummaryContainer.style.display = 'block';
                    }

                    // ÎßåÎÇ® Îç∞Ïù¥ÌÑ∞ Î°úÎìú (Î≥µÏàò ÎßåÎÇ® ÏßÄÏõê)
                    const meetings = this.getMeetingsFromRecord(record);
                    this.renderMeetings(meetings);

                    // ÎßåÎÇ® Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÏúºÎ©¥ ÏÑπÏÖò ÌéºÏπòÍ∏∞
                    if (meetings.length > 0) {
                        document.getElementById('meeting-section').open = true;
                    }
                } else {
                    document.getElementById('delete-btn').style.display = 'none';
                }

                document.getElementById('modal').classList.add('active');
            }

            closeModal() {
                document.getElementById('modal').classList.remove('active');
            }

            saveRecord(e) {
                e.preventDefault();

                const selectedEnergy = document.querySelector('.energy-btn.selected');
                if (!selectedEnergy) {
                    alert('ÏóêÎÑàÏßÄ ÏÉÅÌÉúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî');
                    return;
                }

                const energy = selectedEnergy.dataset.energy;
                const tagsInput = document.getElementById('tags-input').value;
                const tags = tagsInput.split(/\s+/).filter(t => t.startsWith('#')).slice(0, 2);
                const memo = document.getElementById('memo-input').value.trim();

                // ÎßåÎÇ® Îç∞Ïù¥ÌÑ∞ ÏàòÏßë (Î≥µÏàò ÎßåÎÇ®)
                const allMeetings = this.collectMeetingsFromForm();
                // Îπà ÎßåÎÇ® Ìï≠Î™© Ï†úÍ±∞ (ÏµúÏÜå ÌïòÎÇòÏùò ÌïÑÎìúÎùºÎèÑ ÏûÖÎ†•Îêú Í≤ÉÎßå Ï†ÄÏû•)
                const meetings = allMeetings.filter(m => m.time || m.place || m.person);

                if (tags.length === 0) {
                    alert('ÌÉúÍ∑∏Î•º 1Í∞ú Ïù¥ÏÉÅ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî (#ÏúºÎ°ú ÏãúÏûë)');
                    return;
                }

                const dateKey = this.getDateKey(this.selectedDate);
                const existingRecord = this.data[dateKey];

                // ÏöîÏïΩ Î¨∏Ïû• ÏÉùÏÑ±
                const summary = this.generateDailySummary(energy, tags, memo);

                // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• (ÏöîÏïΩ Î∞è Î≥µÏàò ÎßåÎÇ® Ìè¨Ìï®)
                this.data[dateKey] = { energy, tags, memo, summary, meetings };
                this.saveData();

                // Î™®Îã¨ Îã´Í∏∞ (Ï†ÄÏû• ÏßÅÌõÑÏóêÎäî Î¨∏Ïû•ÏùÑ Î≥¥Ïó¨Ï£ºÏßÄ ÏïäÏùå)
                this.closeModal();
                this.renderCalendar();
            }

            deleteRecord() {
                if (confirm('Ïù¥ ÎÇ†Ïùò Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    const dateKey = this.getDateKey(this.selectedDate);
                    delete this.data[dateKey];
                    this.saveData();
                    this.closeModal();
                    this.renderCalendar();
                }
            }

            updateSummaryInModal(summary) {
                const savedSummaryContainer = document.getElementById('saved-summary-container');
                const savedSummaryText = document.getElementById('saved-summary-text');

                if (summary) {
                    savedSummaryText.textContent = summary;
                    savedSummaryContainer.style.display = 'block';
                } else {
                    savedSummaryContainer.style.display = 'none';
                }
            }

            generateDailySummary(energy, tags, memo) {
                console.log('üîÑ ÏöîÏïΩ ÏÉùÏÑ± ÏãúÏûë - ÏóêÎÑàÏßÄ:', energy, 'ÌÉúÍ∑∏:', tags, 'Î©îÎ™®:', memo);

                const recentContext = this.analyzeRecentDays(7);
                const cleanTags = tags.map(tag => tag.replace('#', ''));
                const context = {
                    today: { energy: energy, tags: cleanTags, memo: memo },
                    recent: recentContext,
                    selectedDate: this.selectedDate
                };
                const summary = this.generateWarmSentence(context);

                console.log('‚úÖ ÏöîÏïΩ ÏÉùÏÑ± ÏôÑÎ£å:', summary);
                return summary;
            }

            analyzeRecentDays(days) {
                const today = this.selectedDate;
                const recentRecords = [];
                const energyTrend = [];
                const tagFrequency = {};

                for (let i = 1; i <= days; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = this.getDateKey(date);
                    if (this.data[dateKey]) {
                        const record = this.data[dateKey];
                        recentRecords.push(record);
                        energyTrend.push(record.energy);
                        record.tags.forEach(tag => {
                            const cleanTag = tag.replace('#', '');
                            tagFrequency[cleanTag] = (tagFrequency[cleanTag] || 0) + 1;
                        });
                    }
                }

                const lowCount = energyTrend.filter(e => e === 'ÎÇÆÏùå').length;
                const highCount = energyTrend.filter(e => e === 'ÎÜíÏùå').length;
                const totalCount = energyTrend.length;
                let energyPattern = 'neutral';
                if (totalCount >= 2) {
                    if (lowCount / totalCount > 0.6) energyPattern = 'mostly_low';
                    else if (highCount / totalCount > 0.6) energyPattern = 'mostly_high';
                    else if (lowCount >= 2) energyPattern = 'some_low';
                }

                const frequentTags = Object.entries(tagFrequency)
                    .filter(([tag, count]) => count >= 2)
                    .sort((a, b) => b[1] - a[1])
                    .map(([tag]) => tag);

                return {
                    hasRecentData: recentRecords.length > 0,
                    recordCount: recentRecords.length,
                    energyPattern: energyPattern,
                    frequentTags: frequentTags.slice(0, 3),
                    lastEnergy: energyTrend[0] || null
                };
            }

            generateWarmSentence(context) {
                const { today, recent } = context;
                const { energy, tags, memo } = today;
                const sentiment = this.analyzeSentiment(memo);
                const seed = this.selectedDate.getDate() + this.selectedDate.getMonth() * 31;

                if (recent.hasRecentData && recent.recordCount >= 2) {
                    return this.generateContextualSentence(today, recent, sentiment, seed);
                } else {
                    return this.generateStandaloneSentence(today, sentiment, seed);
                }
            }

            analyzeSentiment(memo) {
                if (!memo) return 'neutral';
                const positiveWords = ['Ï¢ã', 'ÌñâÎ≥µ', 'Í∏∞ÏÅ®', 'Ï¶êÍ±∞', 'ÎßåÏ°±', 'ÏÑ±Í≥µ', 'Ïûò'];
                const negativeWords = ['ÌûòÎì§', 'ÌîºÍ≥§', 'ÏßÄÏπ®', 'Ïñ¥Î†§', 'ÏïÑÏâ¨', 'Ïã§Îßù', 'Î∂àÏïà', 'Î≤ÑÍ±∞'];
                const neutralWords = ['ÏÉùÍ∞Å', 'Í≥†ÎØº', 'Ï†ïÎ¶¨', 'Í≥ÑÌöç', 'Ï§ÄÎπÑ'];
                const memoLower = memo.toLowerCase();
                const hasPositive = positiveWords.some(word => memoLower.includes(word));
                const hasNegative = negativeWords.some(word => memoLower.includes(word));
                const hasNeutral = neutralWords.some(word => memoLower.includes(word));
                if (hasNegative) return 'difficult';
                if (hasPositive) return 'positive';
                if (hasNeutral) return 'thoughtful';
                return 'neutral';
            }

            generateContextualSentence(today, recent, sentiment, seed) {
                const { energy, tags } = today;
                const patterns = [];

                if (recent.energyPattern === 'mostly_low' && energy === 'ÎÇÆÏùå') {
                    patterns.push(
                        'ÏöîÏ¶ò Í≥ÑÏÜç ÌûòÎì† ÏãúÍ∞ÑÏù¥ÏóàÎçò Í±∏ ÏÉùÍ∞ÅÌïòÎ©¥, Ïò§ÎäòÎèÑ ÏâΩÏßÄ ÏïäÏïòÏùÑ Í≤É Í∞ôÏïÑ. Í∑∏ÎûòÎèÑ Ïó¨Í∏∞ÍπåÏßÄ Ïò® Í±∏Î°ú Ï∂©Î∂ÑÌï¥.',
                        'ÏµúÍ∑º Î©∞Ïπ†ÏùÑ Î≥¥Î©¥, Ïò§ÎäòÎèÑ Î≤ÑÌã∞Îäî Í≤É ÏûêÏ≤¥Í∞Ä Ïï†Ïì¥ Í±∞Ïïº.',
                        'ÏöîÏ¶ò ÌùêÎ¶Ñ ÏÜçÏóêÏÑú Ïò§ÎäòÎèÑ ÌïòÎ£®Î•º ÎßàÎ¨¥Î¶¨ÌñàÎã§Îäî Í≤ÉÎßåÏúºÎ°úÎèÑ Í¥úÏ∞ÆÏïÑ.'
                    );
                } else if (recent.energyPattern === 'mostly_low' && energy !== 'ÎÇÆÏùå') {
                    patterns.push(
                        'ÏöîÏ¶ò ÌûòÎì§ÏóàÎçò Í≤É Í∞ôÏùÄÎç∞, Ïò§ÎäòÏùÄ Ï°∞Í∏à ÎÇòÏïÑÏßÑ Í≤É Í∞ôÏïÑ Îã§ÌñâÏù¥Ïïº.',
                        'ÏµúÍ∑º Î©∞Ïπ†ÏùÑ ÏÉùÍ∞ÅÌïòÎ©¥, Ïò§ÎäòÏùÄ Ï°∞Í∏à Ïà®ÌÜµÏù¥ Ìä∏Ïù∏ ÎäêÎÇåÏù¥Ïïº.',
                        'ÏöîÏ¶ò Í≥ÑÏÜç Î≤ÑÍ±∞Ïõ†ÎäîÎç∞, Ïò§ÎäòÏùÄ Í∑∏ÎûòÎèÑ Í¥úÏ∞ÆÏùÄ ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ.'
                    );
                } else if (recent.energyPattern === 'mostly_high' && energy === 'ÎÜíÏùå') {
                    patterns.push(
                        'ÏöîÏ¶ò Í≥ÑÏÜç Î∞îÏÅòÍ≤å Îã¨Î†§Ïò® Í≤É Í∞ôÏïÑ. Ïò§ÎäòÎèÑ Ïó¥Ïã¨Ìûà Î≥¥ÎÉàÍµ¨ÎÇò.',
                        'ÏµúÍ∑º ÌùêÎ¶ÑÏùÑ Î≥¥Î©¥, Ïò§ÎäòÎèÑ ÏßëÏ§ëÌï¥ÏÑú ÌïòÎ£®Î•º Ï±ÑÏö¥ Í≤É Í∞ôÏïÑ.',
                        'ÏöîÏ¶ò Í≥ÑÏÜç ÏõÄÏßÅÏù¥Í≥† ÏûàÏóàÎäîÎç∞, Ïò§ÎäòÎèÑ Í∑∏ ÌùêÎ¶ÑÏù¥ Ïù¥Ïñ¥ÏßÑ ÌïòÎ£®Ïïº.'
                    );
                } else if (recent.energyPattern === 'mostly_high' && energy === 'ÎÇÆÏùå') {
                    patterns.push(
                        'ÏöîÏ¶ò Í≥ÑÏÜç Î∞îÎπ¥Îçò Í±∏ ÏÉùÍ∞ÅÌïòÎ©¥, Ïò§ÎäòÏùÄ Ï¢Ä Ïâ¨Í≥† Ïã∂ÏóàÏùÑ Í≤É Í∞ôÏïÑ.',
                        'ÏµúÍ∑º Í≥ÑÏÜç Îã¨Î†§ÏôîÏúºÎãà, Ïò§ÎäòÏùÄ ÌîºÍ≥§ÌñàÏùÑ ÎßåÎèÑ Ìï¥.',
                        'ÏöîÏ¶ò ÌùêÎ¶ÑÏùÑ Î≥¥Î©¥, Ïò§ÎäòÏùÄ ÌïúÏà® ÎèåÎ¶¨Îäî ÏãúÍ∞ÑÏù¥ ÌïÑÏöîÌñàÎçò Í≤É Í∞ôÏïÑ.'
                    );
                } else if (recent.frequentTags.length > 0) {
                    const repeatedTag = recent.frequentTags[0];
                    const todayHasTag = tags.some(t => t === repeatedTag);
                    if (todayHasTag) {
                        patterns.push(
                            `ÏöîÏ¶ò Í≥ÑÏÜç ${repeatedTag} Ï§ëÏã¨ÏúºÎ°ú ÌïòÎ£®Î•º Î≥¥ÎÇ¥Í≥† ÏûàÎäî Í≤É Í∞ôÏïÑ. Ïò§ÎäòÎèÑ Í∑∏Îü∞ ÌïòÎ£®ÏòÄÍµ¨ÎÇò.`,
                            `ÏµúÍ∑º Î©∞Ïπ†ÏùÑ Î≥¥Î©¥, ${repeatedTag}Ïù¥ Í≥ÑÏÜç ÎÑàÏùò Ï£ºÏöî Í¥ÄÏã¨ÏÇ¨ÏòÄÎçò Í≤É Í∞ôÏïÑ.`,
                            `ÏöîÏ¶ò ${repeatedTag}Ïóê ÏßëÏ§ëÌïòÍ≥† ÏûàÎäî Í≤É Í∞ôÏïÑ. Ïò§ÎäòÎèÑ Í∑∏ ÌùêÎ¶Ñ ÏÜçÏóê ÏûàÏóàÍµ¨ÎÇò.`
                        );
                    } else {
                        patterns.push(
                            `ÏöîÏ¶òÏùÄ Ï£ºÎ°ú ${repeatedTag}Î•º Ï§ëÏã¨ÏúºÎ°ú Î≥¥ÎÉàÎäîÎç∞, Ïò§ÎäòÏùÄ Ï°∞Í∏à Îã§Î•∏ ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ.`,
                            `ÏµúÍ∑º ÌùêÎ¶ÑÍ≥ºÎäî Ï°∞Í∏à Îã§Î•¥Í≤å, Ïò§ÎäòÏùÄ ÎÇòÎ¶ÑÏùò ÌïòÎ£®Î•º Î≥¥ÎÇ∏ Í≤É Í∞ôÏïÑ.`
                        );
                    }
                } else {
                    if (sentiment === 'difficult') {
                        patterns.push(
                            'ÏöîÏ¶ò ÌùêÎ¶Ñ ÏÜçÏóêÏÑú Ïò§ÎäòÎèÑ ÏâΩÏßÄ ÏïäÏùÄ ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ. Í∑∏ÎûòÎèÑ Ïó¨Í∏∞ÍπåÏßÄ ÏôîÏñ¥.',
                            'ÏµúÍ∑º Î©∞Ïπ†ÏùÑ Î≥¥Î©¥, Ïò§ÎäòÎèÑ ÎÑà ÎÇòÎ¶ÑÎåÄÎ°ú ÌïòÎ£®Î•º Î≤ÑÌÖ®ÎÇ∏ Í≤É Í∞ôÏïÑ.',
                            'ÏöîÏ¶òÎèÑ Í∑∏Î†áÍ≥† Ïò§ÎäòÎèÑ Í∑∏Î†áÍ≥†, Ï°∞Ïö©Ìûà Ïï†Ïì∞Í≥† ÏûàÎäî Í≤É Í∞ôÏïÑ.'
                        );
                    } else if (sentiment === 'positive') {
                        patterns.push(
                            'ÏµúÍ∑º Î©∞Ïπ†ÏùÑ Î≥¥Î©¥, Ïò§ÎäòÎèÑ Í¥úÏ∞ÆÏùÄ ÌïòÎ£®Î•º Î≥¥ÎÇ∏ Í≤É Í∞ôÏïÑ.',
                            'ÏöîÏ¶ò ÌùêÎ¶Ñ ÏÜçÏóêÏÑú Ïò§ÎäòÎèÑ ÎÇòÎ¶ÑÎåÄÎ°ú ÏùòÎØ∏ ÏûàÎäî ÏãúÍ∞ÑÏù¥ÏóàÎçò Í≤É Í∞ôÏïÑ.',
                            'ÌÅ∞ ÎßêÏùÄ ÏóÜÏóàÏßÄÎßå, ÏöîÏ¶òÎèÑ Ïò§ÎäòÎèÑ Ïûò ÏßÄÎÇ¥Í≥† ÏûàÎäî Í≤É Í∞ôÏïÑ.'
                        );
                    } else {
                        patterns.push(
                            'ÌÅ∞ ÎßêÏùÄ ÏóÜÏóàÏßÄÎßå, ÏöîÏ¶ò ÌùêÎ¶Ñ ÏÜçÏóêÏÑú Ïò§ÎäòÎèÑ Ï°∞Ïö©Ìûà Ïï†Ïì¥ ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ.',
                            'ÏµúÍ∑º Î©∞Ïπ†ÏùÑ Î≥¥Î©¥, Ïò§ÎäòÎèÑ ÎÑà ÎÇòÎ¶ÑÎåÄÎ°ú ÌïòÎ£®Î•º Ï±ÑÏö¥ Í≤É Í∞ôÏïÑ.',
                            'ÏöîÏ¶òÎèÑ Í∑∏Î†áÍ≥† Ïò§ÎäòÎèÑ Í∑∏Î†áÍ≥†, Í∑∏ÎÉ• ÌïòÎ£®ÌïòÎ£® ÏßÄÎÇòÍ∞ÄÍ≥† ÏûàÍµ¨ÎÇò.',
                            'ÏµúÍ∑º ÌùêÎ¶Ñ ÏÜçÏóêÏÑú Ïò§ÎäòÎèÑ Ï°∞Ïö©Ìûà ÌïòÎ£®Î•º ÎßàÎ¨¥Î¶¨ÌñàÏñ¥.'
                        );
                    }
                }

                if (patterns.length === 0) {
                    patterns.push(
                        'ÏµúÍ∑º Î©∞Ïπ†ÏùÑ Î≥¥Î©¥, Ïò§ÎäòÎèÑ ÎÑà ÎÇòÎ¶ÑÎåÄÎ°ú ÌïòÎ£®Î•º Î≥¥ÎÇ∏ Í≤É Í∞ôÏïÑ.',
                        'ÏöîÏ¶ò ÌùêÎ¶Ñ ÏÜçÏóêÏÑú Ïò§ÎäòÎèÑ ÌïòÎ£®Î•º ÎßàÎ¨¥Î¶¨ÌñàÍµ¨ÎÇò.'
                    );
                }

                return patterns[seed % patterns.length];
            }

            generateStandaloneSentence(today, sentiment, seed) {
                const { energy, tags } = today;
                const patterns = [];

                if (energy === 'ÎÇÆÏùå') {
                    if (sentiment === 'difficult') {
                        patterns.push(
                            'Ïò§ÎäòÏùÄ ÏâΩÏßÄ ÏïäÏùÄ ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ. Í∑∏ÎûòÎèÑ Ïó¨Í∏∞ÍπåÏßÄ Ïò® Í±∏Î°ú Ï∂©Î∂ÑÌï¥.',
                            'ÌûòÎì† ÌïòÎ£®Î•º Î≥¥ÎÉàÍµ¨ÎÇò. Í∑∏Í≤ÉÎßåÏúºÎ°úÎèÑ ÏûòÌïú Í±∞Ïïº.',
                            'Î≤ÑÍ±∞Ïö¥ ÌïòÎ£®ÏòÄÏùÑ Í≤É Í∞ôÏïÑ. Í≥†ÏÉùÌñàÏñ¥.'
                        );
                    } else {
                        patterns.push(
                            'Ïò§ÎäòÏùÄ Ï°∞Ïö©Ìûà Ïâ¨Ïñ¥Í∞ÄÎäî ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ.',
                            'Ïò§ÎäòÏùÄ ÏóêÎÑàÏßÄÎ•º ÏïÑÎÅºÎ©∞ Î≥¥ÎÇ∏ ÌïòÎ£®ÏòÄÍµ¨ÎÇò.',
                            'ÌîºÍ≥§Ìïú ÌïòÎ£®ÏòÄÏùÑ Í≤É Í∞ôÏïÑ. Í¥úÏ∞ÆÏïÑ.'
                        );
                    }
                } else if (energy === 'ÎÜíÏùå') {
                    patterns.push(
                        'Ïò§ÎäòÏùÄ ÏßëÏ§ëÌï¥ÏÑú ÌïòÎ£®Î•º Î≥¥ÎÇ∏ Í≤É Í∞ôÏïÑ.',
                        'ÌôúÍ∏∞Ï∞®Í≤å ÌïòÎ£®Î•º Ï±ÑÏö¥ Í≤É Í∞ôÏïÑ.',
                        'Ïò§ÎäòÏùÄ Ïó¥Ïã¨Ìûà ÏõÄÏßÅÏù∏ ÌïòÎ£®ÏòÄÍµ¨ÎÇò.'
                    );
                } else {
                    if (sentiment === 'difficult') {
                        patterns.push(
                            'Ïò§ÎäòÏùÄ ÎÇòÎ¶ÑÎåÄÎ°ú Î≤ÑÌÖ®ÎÇ∏ ÌïòÎ£®ÏòÄÎçò Í≤É Í∞ôÏïÑ.',
                            'ÏâΩÏßÄÎßåÏùÄ ÏïäÏïòÏßÄÎßå, ÌïòÎ£®Î•º ÎßàÎ¨¥Î¶¨ÌñàÍµ¨ÎÇò.'
                        );
                    } else {
                        patterns.push(
                            'Ïò§ÎäòÎèÑ Í∑∏ÎÉ• ÌïòÎ£®Í∞Ä ÏßÄÎÇòÍ∞îÍµ¨ÎÇò.',
                            'Ïò§ÎäòÏùÄ Í∑∏Î†áÍ≤å ÌïòÎ£®Î•º Î≥¥ÎÉàÏñ¥.',
                            'ÌèâÎ≤îÌïòÍ≤å ÌïòÎ£®Î•º ÎßàÎ¨¥Î¶¨ÌñàÍµ¨ÎÇò.'
                        );
                    }
                }

                return patterns[seed % patterns.length];
            }

            showSummaryModal(summary) {
                console.log('üìù ÏöîÏïΩ Î™®Îã¨ ÌëúÏãú:', summary);
                const summaryModal = document.getElementById('summary-modal');
                const summaryText = document.getElementById('summary-text');

                if (!summaryModal || !summaryText) {
                    console.error('ÏöîÏïΩ Î™®Îã¨ DOM ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                    return;
                }

                summaryText.textContent = summary;
                summaryModal.classList.add('active');
                console.log('‚úÖ ÏöîÏïΩ Î™®Îã¨ ÌôúÏÑ±Ìôî ÏôÑÎ£å');
            }

            closeSummaryModal() {
                document.getElementById('summary-modal').classList.remove('active');
            }

            async copySentenceToClipboard() {
                const sentenceText = document.getElementById('saved-summary-text').textContent;

                if (!sentenceText) {
                    alert('Î≥µÏÇ¨Ìï† Î¨∏Ïû•Ïù¥ ÏóÜÏäµÎãàÎã§');
                    return;
                }

                try {
                    await navigator.clipboard.writeText(sentenceText);
                    alert('Î¨∏Ïû•Ïù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                } catch (err) {
                    console.error('Î≥µÏÇ¨ Ïã§Ìå®:', err);
                    // Ìè¥Î∞±: textarea Î∞©Ïãù
                    const textArea = document.createElement('textarea');
                    textArea.value = sentenceText;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-999999px';
                    document.body.appendChild(textArea);
                    textArea.select();

                    try {
                        document.execCommand('copy');
                        alert('Î¨∏Ïû•Ïù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                    } catch (fallbackErr) {
                        console.error('Ìè¥Î∞± Î≥µÏÇ¨ÎèÑ Ïã§Ìå®:', fallbackErr);
                        alert('Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                    }

                    document.body.removeChild(textArea);
                }
            }

            shareSentence() {
                const sentenceText = document.getElementById('saved-summary-text').textContent;

                if (!sentenceText) {
                    alert('Í≥µÏú†Ìï† Î¨∏Ïû•Ïù¥ ÏóÜÏäµÎãàÎã§');
                    return;
                }

                // Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± Î∞è Í≥µÏú†
                this.generateShareImageFromText(sentenceText);
            }

            generateShareImageFromText(summaryText) {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const width = 800;
                const height = 600;
                canvas.width = width;
                canvas.height = height;

                // Î∞∞Í≤Ω
                const gradient = ctx.createLinearGradient(0, 0, 0, height);
                gradient.addColorStop(0, '#e8f5e9');
                gradient.addColorStop(1, '#c8e6c9');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);

                // ÌÖçÏä§Ìä∏ Ïä§ÌÉÄÏùº
                ctx.fillStyle = '#2e7d32';
                ctx.font = 'bold 28px "Segoe UI", sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // Î¨∏Ïû• Ï§ÑÎ∞îÍøà
                const lines = this.wrapKoreanText(ctx, summaryText, width - 100);
                const lineHeight = 45;
                const startY = (height - (lines.length * lineHeight)) / 2;

                lines.forEach((line, i) => {
                    ctx.fillText(line, width / 2, startY + (i * lineHeight));
                });

                // ÏÑúÎπÑÏä§Î™Ö
                ctx.fillStyle = '#66bb6a';
                ctx.font = '20px "Segoe UI", sans-serif';
                ctx.fillText('ÏöîÏ¶ò Ïñ¥Îïå?', width / 2, height - 50);

                // Ïù¥ÎØ∏ÏßÄ Í≥µÏú†/Îã§Ïö¥Î°úÎìú
                this.shareOrDownloadImage(canvas);
            }

            async copySummaryToClipboard() {
                const summaryText = document.getElementById('summary-text').textContent;

                try {
                    await navigator.clipboard.writeText(summaryText);
                    alert('Î¨∏Ïû•Ïù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                } catch (err) {
                    // Ìè¥Î∞±: textarea ÏÇ¨Ïö©
                    const textarea = document.createElement('textarea');
                    textarea.value = summaryText;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('Î¨∏Ïû•Ïù¥ Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                }
            }

            generateShareImage() {
                const canvas = document.getElementById('share-canvas');
                const ctx = canvas.getContext('2d');
                const summaryText = document.getElementById('summary-text').textContent;

                // Î∞∞Í≤Ω
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, 800, 600);

                // Î©îÏù∏ ÌÖçÏä§Ìä∏ ÏòÅÏó≠
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(40, 150, 720, 280);

                // ÏöîÏïΩ Î¨∏Ïû•
                ctx.fillStyle = '#333333';
                ctx.font = '28px "Segoe UI", sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // Í∏¥ Î¨∏Ïû• Ï§ÑÎ∞îÍøà Ï≤òÎ¶¨
                const maxWidth = 680;
                const words = summaryText.split(' ');
                let line = '';
                let y = 290;
                const lineHeight = 40;

                for (let word of words) {
                    const testLine = line + word;
                    const metrics = ctx.measureText(testLine);

                    if (metrics.width > maxWidth && line !== '') {
                        ctx.fillText(line, 400, y);
                        line = word + ' ';
                        y += lineHeight;
                    } else {
                        line = testLine + ' ';
                    }
                }
                ctx.fillText(line, 400, y);

                // ÌïòÎã® ÏÑúÎπÑÏä§Î™Ö
                ctx.fillStyle = '#999999';
                ctx.font = '18px "Segoe UI", sans-serif';
                ctx.fillText('ÏöîÏ¶ò Ïñ¥Îïå?', 400, 520);

                // Ïù¥ÎØ∏ÏßÄ Îã§Ïö¥Î°úÎìú ÎòêÎäî Í≥µÏú†
                canvas.toBlob((blob) => {
                    const file = new File([blob], 'daily-summary.png', { type: 'image/png' });

                    // Web Share API ÏßÄÏõê ÌôïÏù∏
                    if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                        navigator.share({
                            files: [file],
                            title: 'Ïò§ÎäòÏùò Ìïú Î¨∏Ïû•',
                            text: summaryText
                        }).catch(err => {
                            // Í≥µÏú† Ï∑®ÏÜå Ïãú Îã§Ïö¥Î°úÎìú
                            this.downloadImage(canvas);
                        });
                    } else {
                        // Web Share API ÎØ∏ÏßÄÏõê Ïãú Îã§Ïö¥Î°úÎìú
                        this.downloadImage(canvas);
                    }
                });
            }

            downloadImage(canvas) {
                const link = document.createElement('a');
                link.download = 'daily-summary.png';
                link.href = canvas.toDataURL();
                link.click();
                alert('Ïù¥ÎØ∏ÏßÄÍ∞Ä Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.');
            }

            renderStats() {
                const days = this.statsPeriod;
                const today = new Date();
                const records = [];

                for (let i = 0; i < days; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = this.getDateKey(date);
                    if (this.data[dateKey]) {
                        records.push(this.data[dateKey]);
                    }
                }

                const statsContent = document.getElementById('stats-content');

                if (records.length === 0) {
                    statsContent.innerHTML = '<p style="text-align:center;color:#999;padding:40px;">ÏïÑÏßÅ Í∏∞Î°ùÎêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                    return;
                }

                // ÏóêÎÑàÏßÄ Î∂ÑÌè¨ Í≥ÑÏÇ∞
                const energyCount = { 'ÎÜíÏùå': 0, 'Î≥¥ÌÜµ': 0, 'ÎÇÆÏùå': 0 };
                const tagCount = {};

                records.forEach(record => {
                    energyCount[record.energy]++;
                    record.tags.forEach(tag => {
                        tagCount[tag] = (tagCount[tag] || 0) + 1;
                    });
                });

                const totalRecords = records.length;
                const topTags = Object.entries(tagCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5);

                // Ìï¥ÏÑù ÏÉùÏÑ±
                const insights = this.generateInsights(energyCount, topTags, totalRecords, days);

                // HTML ÏÉùÏÑ±
                let html = '<div class="stats-section">';
                html += '<h3>üìä Í∏∞Í∞Ñ ÏöîÏïΩ</h3>';
                insights.forEach(insight => {
                    html += `<div class="insight">${insight}</div>`;
                });
                html += '</div>';

                // ÏóêÎÑàÏßÄ Ï∞®Ìä∏
                html += '<div class="stats-section">';
                html += '<h3>‚ö° ÏóêÎÑàÏßÄ ÏÉÅÌÉú Î∂ÑÌè¨</h3>';
                html += '<div class="energy-chart">';

                const maxCount = Math.max(...Object.values(energyCount));
                ['ÎÜíÏùå', 'Î≥¥ÌÜµ', 'ÎÇÆÏùå'].forEach(energy => {
                    const count = energyCount[energy];
                    const percentage = maxCount > 0 ? (count / maxCount * 100) : 0;
                    const type = energy === 'ÎÜíÏùå' ? 'high' : energy === 'Î≥¥ÌÜµ' ? 'medium' : 'low';
                    const emoji = energy === 'ÎÜíÏùå' ? 'üî•' : energy === 'Î≥¥ÌÜµ' ? '‚ö°' : 'üåô';

                    html += `
                        <div class="energy-bar">
                            <div class="bar">
                                <div class="bar-fill ${type}" style="height: ${percentage}%"></div>
                                <div class="bar-value">${count}Ïùº</div>
                            </div>
                            <div class="bar-label">${emoji} ${energy}</div>
                        </div>
                    `;
                });
                html += '</div></div>';

                // ÌÉúÍ∑∏ ÏàúÏúÑ
                if (topTags.length > 0) {
                    html += '<div class="stats-section">';
                    html += '<h3>üè∑Ô∏è ÏûêÏ£º Îì±Ïû•Ìïú ÌÉúÍ∑∏</h3>';
                    html += '<div class="tag-list">';
                    topTags.forEach(([tag, count]) => {
                        html += `<div class="tag-item">${tag} <span class="tag-count">${count}</span></div>`;
                    });
                    html += '</div></div>';
                }

                statsContent.innerHTML = html;
            }

            generateInsights(energyCount, topTags, totalRecords, days) {
                const insights = [];

                // ÏóêÎÑàÏßÄ Ìï¥ÏÑù
                const highRatio = energyCount['ÎÜíÏùå'] / totalRecords;
                const lowRatio = energyCount['ÎÇÆÏùå'] / totalRecords;

                insights.push(`ÏµúÍ∑º ${days}Ïùº Ï§ë ${totalRecords}ÏùºÏùò Í∏∞Î°ùÏù¥ ÏûàÏäµÎãàÎã§.`);

                if (lowRatio > 0.5) {
                    insights.push('ÏµúÍ∑º ÏóêÎÑàÏßÄÍ∞Ä ÎÇÆÏùÄ ÎÇ†Ïù¥ Ï†àÎ∞ò Ïù¥ÏÉÅÏùÑ Ï∞®ÏßÄÌñàÏäµÎãàÎã§. Ï∂©Î∂ÑÌïú Ìú¥ÏãùÏù¥ ÌïÑÏöîÌï¥ Î≥¥ÏûÖÎãàÎã§.');
                } else if (highRatio > 0.5) {
                    insights.push('ÏµúÍ∑º ÏóêÎÑàÏßÄÍ∞Ä ÎÜíÏùÄ ÎÇ†Ïù¥ ÎßéÏïòÏäµÎãàÎã§. Ï¢ãÏùÄ Ïª®ÎîîÏÖòÏùÑ Ïú†ÏßÄÌïòÍ≥† Í≥ÑÏãúÎÑ§Ïöî!');
                } else if (energyCount['Î≥¥ÌÜµ'] > energyCount['ÎÜíÏùå'] && energyCount['Î≥¥ÌÜµ'] > energyCount['ÎÇÆÏùå']) {
                    insights.push('ÏµúÍ∑º ÏóêÎÑàÏßÄ ÏÉÅÌÉúÍ∞Ä ÏïàÏ†ïÏ†ÅÏúºÎ°ú Ïú†ÏßÄÎêòÍ≥† ÏûàÏäµÎãàÎã§.');
                }

                // ÌÉúÍ∑∏ Ìï¥ÏÑù
                if (topTags.length > 0) {
                    const [topTag, topCount] = topTags[0];
                    insights.push(`Í∞ÄÏû• ÏûêÏ£º Îì±Ïû•Ìïú ÌÉúÍ∑∏Îäî ${topTag} ÏûÖÎãàÎã§. (${topCount}Ìöå)`);

                    if (topTags.length > 1) {
                        const secondTag = topTags[1][0];
                        insights.push(`${topTag}ÏôÄ ${secondTag} Ìå®ÌÑ¥Ïù¥ ÎëêÎìúÎü¨ÏßëÎãàÎã§.`);
                    }
                }

                return insights;
            }

            bindEvents() {
                // ÌÉ≠ Ï†ÑÌôò
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));

                        tab.classList.add('active');
                        const view = tab.dataset.view;
                        document.getElementById(`${view}-view`).classList.add('active');

                        if (view === 'stats') {
                            this.renderStats();
                        }
                    });
                });

                // Ïõî Ïù¥Îèô
                document.getElementById('prev-month').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.renderCalendar();
                });

                document.getElementById('next-month').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.renderCalendar();
                });

                // Î™®Îã¨
                document.getElementById('close-modal').addEventListener('click', () => this.closeModal());
                document.getElementById('modal').addEventListener('click', (e) => {
                    if (e.target.id === 'modal') this.closeModal();
                });

                // ÏóêÎÑàÏßÄ ÏÑ†ÌÉù
                document.querySelectorAll('.energy-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.energy-btn').forEach(b => b.classList.remove('selected'));
                        btn.classList.add('selected');
                    });
                });

                // Ìèº Ï†úÏ∂ú
                document.getElementById('record-form').addEventListener('submit', (e) => this.saveRecord(e));
                document.getElementById('delete-btn').addEventListener('click', () => this.deleteRecord());

                // ÎßåÎÇ® Ï∂îÍ∞Ä Î≤ÑÌäº
                document.getElementById('add-meeting-btn').addEventListener('click', () => this.addMeetingEntry());

                // ÌÜµÍ≥Ñ Í∏∞Í∞Ñ ÏÑ†ÌÉù
                document.querySelectorAll('.period-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.statsPeriod = parseInt(btn.dataset.period);
                        this.renderStats();
                    });
                });

                // ÏöîÏïΩ Î™®Îã¨ Ïù¥Î≤§Ìä∏
                document.getElementById('close-summary-modal').addEventListener('click', () => this.closeSummaryModal());
                document.getElementById('summary-modal').addEventListener('click', (e) => {
                    if (e.target.id === 'summary-modal') this.closeSummaryModal();
                });

                // Î≥µÏÇ¨ Î≤ÑÌäº
                document.getElementById('copy-summary-btn').addEventListener('click', () => this.copySummaryToClipboard());

                // Í≥µÏú† Î≤ÑÌäº
                document.getElementById('share-summary-btn').addEventListener('click', () => this.generateShareImage());

                // Î™®Îã¨ ÎÇ¥ Î≥µÏÇ¨/Í≥µÏú† Î≤ÑÌäº
                document.getElementById('copy-sentence-btn').addEventListener('click', () => this.copySentenceToClipboard());
                document.getElementById('share-sentence-btn').addEventListener('click', () => this.shareSentence());
            }
        }

        // Ïï± ÏãúÏûë
        window.addEventListener('DOMContentLoaded', () => {
            new DailyStatsApp();
        });
    </script>
</body>
</html>
