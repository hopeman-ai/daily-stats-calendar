<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš”ì¦˜ ì–´ë•Œ?</title>

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="ìš”ì¦˜ ì–´ë•Œ?" />
    <meta property="og:description" content="ë‚˜ë¥¼ ë³´ëŠ” ìº˜ë¦°ë”" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://hopeman-ai.github.io/daily-stats-calendar/" />
    <meta property="og:image" content="https://hopeman-ai.github.io/daily-stats-calendar/now-icon.png" />
    <meta name="description" content="ìš”ì¦˜ ì–´ë•Œ? - ë‚˜ë¥¼ ë³´ëŠ” ìº˜ë¦°ë”" />

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 10px;
        }

        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
            line-height: 1.2;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5em;
        }

        .title-icon {
            width: 1.45em;
            height: 1.45em;
            flex-shrink: 0;
            object-fit: contain;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 8px 15px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            color: #666;
            transition: all 0.3s;
        }

        .tab.active {
            color: #4CAF50;
            border-bottom: 3px solid #4CAF50;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* í™ˆ íƒœê·¸ë¼ì¸ */
        .home-tagline {
            text-align: center;
            color: #b0b0b0;
            font-size: 13px;
            font-weight: 400;
            letter-spacing: 0.02em;
            margin: 0 0 20px 0;
            padding: 0;
            line-height: 1.6;
        }

        /* ìº˜ë¦°ë” ìŠ¤íƒ€ì¼ */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .calendar-header button {
            padding: 6px 10px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
        }

        .calendar-header button:hover {
            background: #45a049;
        }

        .calendar-header h2 {
            color: #333;
            font-size: 1.1rem;
            text-align: center;
            flex: 1;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            width: 100%;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: bold;
            padding: 5px 2px;
            color: #666;
            font-size: 11px;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            padding: 4px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .calendar-day:hover {
            background: #f0f0f0;
            transform: scale(1.05);
        }

        .calendar-day.empty {
            cursor: default;
            background: #fafafa;
        }

        .calendar-day.empty:hover {
            transform: none;
        }

        .calendar-day.today {
            border: 2px solid #4CAF50;
        }

        .calendar-day.has-data {
            background: #e8f5e9;
        }

        .day-number {
            font-weight: bold;
            margin-bottom: 2px;
            font-size: 11px;
        }

        .day-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 10px;
        }

        /* ì…ë ¥ ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .modal-header h2 {
            font-size: 1.2rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .energy-options {
            display: flex;
            gap: 6px;
        }

        .energy-btn {
            flex: 1;
            padding: 10px 4px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
        }

        .energy-btn:hover {
            border-color: #4CAF50;
        }

        .energy-btn.selected {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 14px;
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        .save-btn {
            width: 100%;
            padding: 12px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 15px;
            cursor: pointer;
        }

        .save-btn:hover {
            background: #45a049;
        }

        .delete-btn {
            width: 100%;
            padding: 10px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 5px;
            margin-top: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .delete-btn:hover {
            background: #da190b;
        }

        .help-text {
            font-size: 11px;
            color: #999;
            margin-top: 4px;
        }

        /* ë§Œë‚¨ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .meeting-section {
            margin-top: 15px;
            padding: 12px;
            background: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }

        .meeting-toggle {
            cursor: pointer;
            user-select: none;
            font-weight: 500;
            color: #666;
            font-size: 14px;
            list-style: none;
        }

        .meeting-toggle::-webkit-details-marker {
            display: none;
        }

        .meeting-toggle::before {
            content: 'â–¶';
            display: inline-block;
            margin-right: 5px;
            transition: transform 0.2s;
            font-size: 10px;
        }

        details[open] .meeting-toggle::before {
            transform: rotate(90deg);
        }

        .meeting-fields {
            margin-top: 12px;
        }

        .meeting-field {
            margin-bottom: 10px;
        }

        .meeting-field:last-child {
            margin-bottom: 0;
        }

        .meeting-field label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            color: #666;
        }

        .meeting-field input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .meeting-field input::placeholder {
            color: #aaa;
        }

        /* ìº˜ë¦°ë” ë‚ ì§œ ë§Œë‚¨ ì•„ì´ì½˜ */
        .meeting-indicator {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            opacity: 0.5;
        }

        .meeting-count {
            font-size: 8px;
            vertical-align: super;
            margin-left: 1px;
        }

        /* ë³µìˆ˜ ë§Œë‚¨ UI ìŠ¤íƒ€ì¼ */
        .meetings-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .meeting-entry {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            position: relative;
        }

        .meeting-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }

        .meeting-entry-title {
            font-size: 13px;
            font-weight: 600;
            color: #4CAF50;
        }

        .remove-meeting-btn {
            background: #ff5252;
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .remove-meeting-btn:hover {
            background: #d32f2f;
        }

        .add-meeting-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            background: #e8f5e9;
            border: 2px dashed #4CAF50;
            border-radius: 8px;
            color: #4CAF50;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-meeting-btn:hover {
            background: #c8e6c9;
        }

        .meeting-entry .meeting-field {
            margin-bottom: 8px;
        }

        .meeting-entry .meeting-field:last-child {
            margin-bottom: 0;
        }

        .no-meetings-message {
            text-align: center;
            color: #999;
            font-size: 13px;
            padding: 15px;
        }

        /* ì²« ë°©ë¬¸ì í™˜ì˜ ëª¨ë‹¬ */
        .welcome-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 3000;
        }

        .welcome-modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .welcome-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .welcome-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .welcome-title {
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            font-size: 0.95rem;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .welcome-notice {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .welcome-notice-icon {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .welcome-notice-text {
            font-size: 13px;
            color: #666;
            line-height: 1.5;
        }

        .welcome-start-btn {
            width: 100%;
            padding: 14px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }

        .welcome-start-btn:hover {
            background: #45a049;
        }

        /* ë°ì´í„° ì €ì¥ ìœ„ì¹˜ ì•ˆë‚´ (í‘¸í„°) */
        .privacy-notice {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            color: #aaa;
            font-size: 11px;
            margin-top: 15px;
        }

        .privacy-notice-icon {
            font-size: 12px;
        }

        /* í†µê³„ ìŠ¤íƒ€ì¼ */
        .stats-controls {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .period-btn {
            padding: 8px 15px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
        }

        .period-btn.active {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .stats-section {
            margin-bottom: 25px;
        }

        .stats-section h3 {
            color: #333;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .insight {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 8px;
            line-height: 1.5;
            color: #1976d2;
            font-size: 13px;
        }

        .energy-chart {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .energy-bar {
            flex: 1;
            text-align: center;
        }

        .bar {
            height: 150px;
            background: #e0e0e0;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .bar-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: #4CAF50;
            transition: height 0.3s;
        }

        .bar-fill.high {
            background: #4CAF50;
        }

        .bar-fill.medium {
            background: #FFC107;
        }

        .bar-fill.low {
            background: #f44336;
        }

        .bar-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            font-size: 14px;
        }

        .bar-label {
            margin-top: 8px;
            font-weight: bold;
            font-size: 12px;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .tag-item {
            background: #4CAF50;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
        }

        .tag-count {
            background: rgba(255,255,255,0.3);
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 4px;
        }

        /* ìš”ì•½ ê²°ê³¼ ëª¨ë‹¬ */
        .summary-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
        }

        .summary-modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .summary-content {
            background: white;
            padding: 25px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .summary-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .summary-header h2 {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 5px;
        }

        .summary-header .sub-title {
            font-size: 0.9rem;
            color: #999;
        }

        .summary-text {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            line-height: 1.8;
            font-size: 15px;
            color: #333;
            margin-bottom: 20px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .summary-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .summary-btn {
            flex: 1;
            padding: 12px;
            border: 1px solid #e0e0e0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .summary-btn:hover {
            background: #f5f5f5;
            border-color: #4CAF50;
        }

        .summary-btn.primary {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .summary-btn.primary:hover {
            background: #45a049;
        }

        .summary-close {
            width: 100%;
            padding: 10px;
            background: #e0e0e0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .summary-close:hover {
            background: #d0d0d0;
        }

        .share-canvas {
            display: none;
        }

        .saved-summary {
            margin-top: 15px;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }

        .saved-summary-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .saved-summary-text {
            font-size: 14px;
            color: #333;
            line-height: 1.6;
        }

        /* ì˜¤ëŠ˜ì˜ í•œ ë¬¸ì¥ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .saved-summary .summary-btn:hover {
            background: #4CAF50 !important;
            color: white !important;
        }

        .saved-summary .summary-btn:active {
            transform: scale(0.98);
        }

        /* Copyright */
        .copyright {
            text-align: center;
            color: #999;
            font-size: 11px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        /* ë°ìŠ¤í¬í†± ìµœì í™” (768px ì´ìƒ) */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }

            .container {
                max-width: 1200px;
                padding: 30px;
            }

            h1 {
                font-size: 2rem;
                margin-bottom: 30px;
                gap: 0.6em;
            }

            .title-icon {
                width: 1.6em;
                height: 1.6em;
            }

            .tabs {
                gap: 10px;
                margin-bottom: 30px;
            }

            .tab {
                padding: 10px 20px;
                font-size: 16px;
            }

            .home-tagline {
                font-size: 15px;
                margin: 0 0 25px 0;
                letter-spacing: 0.03em;
            }

            .calendar-header {
                margin-bottom: 20px;
            }

            .calendar-header button {
                padding: 8px 15px;
                font-size: 14px;
            }

            .calendar-header h2 {
                font-size: 1.5rem;
            }

            .calendar-grid {
                gap: 10px;
            }

            .calendar-day-header {
                padding: 10px;
                font-size: 14px;
            }

            .calendar-day {
                padding: 10px;
                border-radius: 5px;
            }

            .day-number {
                font-size: 14px;
                margin-bottom: 5px;
            }

            .day-indicator {
                font-size: 12px;
                bottom: 5px;
                right: 5px;
            }

            .stats-controls {
                gap: 10px;
                margin-bottom: 30px;
            }

            .period-btn {
                padding: 10px 20px;
                font-size: 14px;
            }

            .stats-section {
                margin-bottom: 30px;
            }

            .stats-section h3 {
                font-size: 1.3rem;
                margin-bottom: 15px;
            }

            .insight {
                padding: 15px;
                font-size: 14px;
                margin-bottom: 10px;
            }

            .energy-chart {
                gap: 20px;
                margin: 20px 0;
            }

            .bar {
                height: 200px;
            }

            .bar-value {
                font-size: 18px;
            }

            .bar-label {
                margin-top: 10px;
                font-size: 14px;
            }

            .tag-list {
                gap: 10px;
                margin-top: 15px;
            }

            .tag-item {
                padding: 8px 15px;
                font-size: 14px;
            }

            .tag-count {
                padding: 2px 8px;
                margin-left: 5px;
            }

            .modal-content {
                padding: 30px;
            }

            .modal-header {
                margin-bottom: 20px;
            }

            .modal-header h2 {
                font-size: 1.5rem;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .energy-options {
                gap: 10px;
            }

            .energy-btn {
                padding: 12px;
                font-size: 14px;
            }

            .save-btn {
                font-size: 16px;
            }

            .delete-btn {
                margin-top: 10px;
            }

            .help-text {
                font-size: 12px;
                margin-top: 5px;
            }

            .summary-content {
                padding: 35px;
            }

            .summary-header h2 {
                font-size: 1.5rem;
            }

            .summary-text {
                padding: 25px;
                font-size: 16px;
            }

            .summary-btn {
                padding: 14px;
                font-size: 15px;
            }

            .saved-summary {
                padding: 18px;
            }

            .saved-summary-label {
                font-size: 13px;
            }

            .saved-summary-text {
                font-size: 15px;
            }

            .copyright {
                font-size: 12px;
                margin-top: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <img src="now-icon.png" alt="Calendar" class="title-icon">
            ìš”ì¦˜ ì–´ë•Œ?
        </h1>

        <div class="tabs">
            <button class="tab active" data-view="calendar">ìº˜ë¦°ë”</button>
            <button class="tab" data-view="stats">í†µê³„</button>
        </div>

        <!-- ìº˜ë¦°ë” ë·° -->
        <div id="calendar-view" class="view active">
            <p class="home-tagline">ë‚ ì§œ ìœ„ì— ë‚¨ëŠ” ê²ƒì€ ê¸°ì–µì…ë‹ˆë‹¤</p>
            <div class="calendar-header">
                <button id="prev-month">â—€ ì´ì „</button>
                <h2 id="current-month"></h2>
                <button id="next-month">ë‹¤ìŒ â–¶</button>
            </div>
            <div class="calendar-grid" id="calendar-grid"></div>
        </div>

        <!-- í†µê³„ ë·° -->
        <div id="stats-view" class="view">
            <div class="stats-controls">
                <button class="period-btn active" data-period="7">ìµœê·¼ 7ì¼</button>
                <button class="period-btn" data-period="30">ìµœê·¼ 30ì¼</button>
            </div>
            <div id="stats-content"></div>
        </div>

        <div class="privacy-notice">
            <span class="privacy-notice-icon">ğŸ”’</span>
            <span>ëª¨ë“  ê¸°ë¡ì€ ì´ ê¸°ê¸°ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤</span>
        </div>

        <div class="copyright">
            Copyright 2026. Heeseok Choi
        </div>
    </div>

    <!-- ì²« ë°©ë¬¸ì í™˜ì˜ ëª¨ë‹¬ -->
    <div id="welcome-modal" class="welcome-modal">
        <div class="welcome-content">
            <div class="welcome-icon">ğŸ“…</div>
            <h2 class="welcome-title">ìš”ì¦˜ ì–´ë•Œ?</h2>
            <p class="welcome-subtitle">í•˜ë£¨í•˜ë£¨ì˜ ì—ë„ˆì§€ì™€ ê°ì •ì„<br>ê¸°ë¡í•˜ëŠ” ë‚˜ë§Œì˜ ìº˜ë¦°ë”</p>

            <div class="welcome-notice">
                <div class="welcome-notice-icon">ğŸ”’</div>
                <p class="welcome-notice-text">
                    ëª¨ë“  ê¸°ë¡ì€ <strong>ì´ ê¸°ê¸°ì˜ ë¸Œë¼ìš°ì €</strong>ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.<br>
                    ë‹¤ë¥¸ ì‚¬ëŒê³¼ URLì„ ê³µìœ í•´ë„ ë‚´ ê¸°ë¡ì€ ë³´ì´ì§€ ì•Šì•„ìš”.
                </p>
            </div>

            <button class="welcome-start-btn" id="welcome-start-btn">ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>

    <!-- ì…ë ¥ ëª¨ë‹¬ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">ë‚ ì§œ ê¸°ë¡</h2>
                <button class="close-btn" id="close-modal">Ã—</button>
            </div>

            <form id="record-form">
                <div class="form-group">
                    <label>í•˜ë£¨ì˜ ë°€ë„</label>
                    <div class="energy-options">
                        <button type="button" class="energy-btn" data-energy="ë†’ìŒ">ë†’ìŒ ğŸ”¥</button>
                        <button type="button" class="energy-btn" data-energy="ë³´í†µ">ë³´í†µ âš¡</button>
                        <button type="button" class="energy-btn" data-energy="ë‚®ìŒ">ë‚®ìŒ ğŸŒ™</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>í•˜ë£¨ íƒœê·¸</label>
                    <input type="text" id="tags-input" placeholder="#ì§‘ì¤‘ #íœ´ì‹" />
                    <div class="help-text">#ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” íƒœê·¸ë¥¼ 1~2ê°œ ì…ë ¥í•˜ì„¸ìš”</div>
                </div>

                <div class="form-group">
                    <label>ë©”ëª¨ (ì„ íƒ)</label>
                    <textarea id="memo-input" placeholder="ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ í•œ ì¤„ë¡œ ê¸°ë¡í•´ë³´ì„¸ìš”"></textarea>
                </div>

                <!-- ë§Œë‚¨ ê¸°ë¡ (ì„ íƒ) - ë³µìˆ˜ ë§Œë‚¨ ì§€ì› -->
                <details class="form-group meeting-section" id="meeting-section">
                    <summary class="meeting-toggle">
                        <span>ë§Œë‚¨ (ì„ íƒ)</span>
                    </summary>
                    <div class="meeting-fields">
                        <div id="meetings-container" class="meetings-container">
                            <!-- ë§Œë‚¨ í•­ëª©ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </div>
                        <button type="button" class="add-meeting-btn" id="add-meeting-btn">
                            <span>+</span> ë§Œë‚¨ ì¶”ê°€
                        </button>
                    </div>
                </details>

                <button type="submit" class="save-btn">ì €ì¥</button>
                <button type="button" class="delete-btn" id="delete-btn" style="display:none;">ì‚­ì œ</button>
            </form>

            <!-- ì €ì¥ëœ ìš”ì•½ í‘œì‹œ -->
            <div id="saved-summary-container" style="display:none;">
                <div class="saved-summary">
                    <div class="saved-summary-label">ì˜¤ëŠ˜ì˜ í•œ ë¬¸ì¥</div>
                    <div class="saved-summary-text" id="saved-summary-text"></div>

                    <!-- ë²„íŠ¼ ì˜ì—­ -->
                    <div class="summary-actions" style="display: flex; gap: 8px; margin-top: 15px;">
                        <button type="button" class="summary-btn" id="copy-sentence-btn" style="flex: 1; padding: 10px; border: 1px solid #4CAF50; background: white; color: #4CAF50; border-radius: 5px; cursor: pointer; font-size: 13px; transition: all 0.3s;">ğŸ“‹ ë¬¸ì¥ ë³µì‚¬</button>
                        <button type="button" class="summary-btn" id="share-sentence-btn" style="flex: 1; padding: 10px; border: 1px solid #4CAF50; background: white; color: #4CAF50; border-radius: 5px; cursor: pointer; font-size: 13px; transition: all 0.3s;">ğŸ“¤ ì›í•˜ë©´ ê³µìœ </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ìš”ì•½ ê²°ê³¼ ëª¨ë‹¬ -->
    <div id="summary-modal" class="summary-modal">
        <div class="summary-content">
            <div class="summary-header">
                <h2>ì˜¤ëŠ˜ì˜ í•œ ë¬¸ì¥</h2>
                <p class="sub-title">ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤</p>
            </div>

            <div class="summary-text" id="summary-text"></div>

            <div class="summary-actions">
                <button class="summary-btn" id="copy-summary-btn">ğŸ“‹ ë¬¸ì¥ ë³µì‚¬</button>
                <button class="summary-btn" id="share-summary-btn">ğŸ“¤ ì›í•˜ë©´ ê³µìœ </button>
            </div>

            <button class="summary-close" id="close-summary-modal">í™•ì¸</button>
        </div>
    </div>

    <!-- ê³µìœ ìš© ìº”ë²„ìŠ¤ (ìˆ¨ê¹€) -->
    <canvas id="share-canvas" class="share-canvas" width="800" height="600"></canvas>

    <script>
        /**
         * ============================================================
         * ë°ì´í„° ê´€ë¦¬ì (DataManager)
         * ============================================================
         *
         * [í”„ë¼ì´ë²„ì‹œ ì„¤ê³„ ì›ì¹™]
         * 1. ëª¨ë“  ë°ì´í„°ëŠ” ì˜¤ì§ ì´ ë¸Œë¼ìš°ì €ì˜ localStorageì—ë§Œ ì €ì¥
         * 2. URL, ì¿ í‚¤, ì„œë²„ì—ëŠ” ì ˆëŒ€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒ
         * 3. URL ê³µìœ  ì‹œ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ë°ì´í„°ê°€ ì „ë‹¬ë˜ì§€ ì•ŠìŒ
         * 4. ê° ë¸Œë¼ìš°ì €ëŠ” ì™„ì „íˆ ë…ë¦½ëœ ë°ì´í„° ê³µê°„ì„ ê°€ì§
         *
         * [localStorage í‚¤ êµ¬ì¡°]
         * - yozumeottae_calendar_v1    : ìº˜ë¦°ë” ê¸°ë¡ ë°ì´í„° (í•µì‹¬)
         * - yozumeottae_visited        : ì²« ë°©ë¬¸ ì—¬ë¶€ (í™˜ì˜ ëª¨ë‹¬ìš©)
         * - yozumeottae_browser_id     : ë¸Œë¼ìš°ì € ì‹ë³„ì (ë””ë²„ê¹…ìš©)
         *
         * [ë°ì´í„°ê°€ ê³µìœ ë˜ì§€ ì•ŠëŠ” ì´ìœ ]
         * localStorageëŠ” ì›¹ ë¸Œë¼ìš°ì €ì˜ 'ë™ì¼ ì¶œì²˜ ì •ì±…(Same-Origin Policy)'ì— ë”°ë¼
         * ê°™ì€ ë„ë©”ì¸ + ê°™ì€ ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.
         *
         * ì˜ˆì‹œ:
         * - ì‚¬ìš©ì Aê°€ Chromeì—ì„œ ê¸°ë¡ â†’ Aì˜ Chrome localStorageì—ë§Œ ì €ì¥
         * - ì‚¬ìš©ì Bê°€ ê°™ì€ URLì„ Safariì—ì„œ ì—´ê¸° â†’ Bì˜ Safari localStorageëŠ” ë¹„ì–´ìˆìŒ
         * - ë”°ë¼ì„œ BëŠ” ë¹ˆ ìº˜ë¦°ë”ë¥¼ ë³´ê²Œ ë¨
         *
         * URL ê³µìœ  ì‹œ ì „ë‹¬ë˜ëŠ” ê²ƒ: ì•± ì£¼ì†Œë§Œ (ë°ì´í„° ì—†ìŒ)
         * ì „ë‹¬ë˜ì§€ ì•ŠëŠ” ê²ƒ: localStorage ë‚´ìš©, ì‚¬ìš©ì ê¸°ë¡
         */
        class DataManager {
            // localStorage í‚¤ ìƒìˆ˜ (ì•± ì „ìš© ë„¤ì„ìŠ¤í˜ì´ìŠ¤)
            static KEYS = {
                CALENDAR_DATA: 'yozumeottae_calendar_v1',    // ìº˜ë¦°ë” ê¸°ë¡
                VISITED: 'yozumeottae_visited',               // ì²« ë°©ë¬¸ ì—¬ë¶€
                BROWSER_ID: 'yozumeottae_browser_id'          // ë¸Œë¼ìš°ì € ì‹ë³„ì
            };

            constructor() {
                this._data = null;
                this._ensureBrowserId();
            }

            /**
             * ë¸Œë¼ìš°ì € ê³ ìœ  ì‹ë³„ì ìƒì„± (ë””ë²„ê¹…/ë¶„ì„ìš©)
             * ì‹¤ì œ ì‚¬ìš©ì ì‹ë³„ì´ ì•„ë‹Œ, ê°™ì€ ë¸Œë¼ìš°ì €ì¸ì§€ í™•ì¸ìš©
             */
            _ensureBrowserId() {
                let browserId = localStorage.getItem(DataManager.KEYS.BROWSER_ID);
                if (!browserId) {
                    browserId = 'browser_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem(DataManager.KEYS.BROWSER_ID, browserId);
                    console.log('[Privacy] New browser session initialized:', browserId);
                }
                this._browserId = browserId;
            }

            /**
             * URLì—ì„œ ë°ì´í„° ê´€ë ¨ íŒŒë¼ë¯¸í„° ì œê±°
             * ëˆ„êµ°ê°€ URLì— ë°ì´í„°ë¥¼ ë‹´ì•„ ê³µìœ í•˜ë ¤ í•´ë„ ë¬´ì‹œí•¨
             */
            sanitizeUrl() {
                const url = new URL(window.location.href);
                const dangerousParams = ['data', 'calendar', 'records', 'import', 'share', 'state', 'backup'];
                let modified = false;

                dangerousParams.forEach(param => {
                    if (url.searchParams.has(param)) {
                        url.searchParams.delete(param);
                        modified = true;
                        console.log(`[Privacy] Blocked URL parameter: ${param}`);
                    }
                });

                // URL í•´ì‹œì— ë°ì´í„°ê°€ ìˆì„ ê²½ìš°ë„ ì œê±°
                if (url.hash && url.hash.length > 1) {
                    try {
                        // base64 ì¸ì½”ë”©ëœ ë°ì´í„° ê°ì§€ ì‹œë„
                        const hashContent = url.hash.substring(1);
                        if (hashContent.length > 50 || hashContent.includes('eyJ')) {
                            url.hash = '';
                            modified = true;
                            console.log('[Privacy] Blocked suspicious URL hash');
                        }
                    } catch (e) {
                        // ë¬´ì‹œ
                    }
                }

                if (modified) {
                    window.history.replaceState({}, '', url.pathname + url.search + url.hash);
                }
            }

            /**
             * ìº˜ë¦°ë” ë°ì´í„° ë¡œë“œ
             * ì˜¤ì§ ì´ ë¸Œë¼ìš°ì €ì˜ localStorageì—ì„œë§Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
             */
            loadCalendarData() {
                try {
                    const stored = localStorage.getItem(DataManager.KEYS.CALENDAR_DATA);
                    this._data = stored ? JSON.parse(stored) : {};
                    console.log(`[Data] Loaded ${Object.keys(this._data).length} records from local storage`);
                } catch (e) {
                    console.error('[Data] Failed to load data, starting fresh:', e);
                    this._data = {};
                }
                return this._data;
            }

            /**
             * ìº˜ë¦°ë” ë°ì´í„° ì €ì¥
             * ì˜¤ì§ ì´ ë¸Œë¼ìš°ì €ì˜ localStorageì—ë§Œ ì €ì¥
             * - ì„œë²„ ì „ì†¡: ì—†ìŒ
             * - URL ë…¸ì¶œ: ì—†ìŒ
             * - ì¿ í‚¤ ì €ì¥: ì—†ìŒ
             */
            saveCalendarData(data) {
                try {
                    this._data = data;
                    localStorage.setItem(DataManager.KEYS.CALENDAR_DATA, JSON.stringify(data));
                    console.log(`[Data] Saved ${Object.keys(data).length} records to local storage`);
                } catch (e) {
                    console.error('[Data] Failed to save data:', e);
                    alert('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì €ì¥ ê³µê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }
            }

            /**
             * ì²« ë°©ë¬¸ ì—¬ë¶€ í™•ì¸
             */
            isFirstVisit() {
                return !localStorage.getItem(DataManager.KEYS.VISITED);
            }

            /**
             * ì²« ë°©ë¬¸ ì™„ë£Œ í‘œì‹œ
             */
            markAsVisited() {
                localStorage.setItem(DataManager.KEYS.VISITED, 'true');
            }

            /**
             * í˜„ì¬ ë¸Œë¼ìš°ì € ID ë°˜í™˜ (ë””ë²„ê¹…ìš©)
             */
            getBrowserId() {
                return this._browserId;
            }

            /**
             * ëª¨ë“  ë°ì´í„° ì‚­ì œ (ì´ˆê¸°í™” ê¸°ëŠ¥ìš©)
             */
            clearAllData() {
                Object.values(DataManager.KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                this._data = {};
                console.log('[Data] All data cleared');
            }
        }

        /**
         * ============================================================
         * ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
         * ============================================================
         */
        class DailyStatsApp {
            constructor() {
                this.currentDate = new Date();
                this.selectedDate = null;
                this.currentView = 'calendar';
                this.statsPeriod = 7;

                // ë°ì´í„° ê´€ë¦¬ì ì´ˆê¸°í™”
                this.dataManager = new DataManager();
                this.data = {};

                this.init();
            }

            init() {
                // 1ë‹¨ê³„: URL ë³´ì•ˆ (ë°ì´í„° íŒŒë¼ë¯¸í„° ì œê±°)
                this.dataManager.sanitizeUrl();

                // 2ë‹¨ê³„: ë¡œì»¬ ë°ì´í„° ë¡œë“œ (ì´ ë¸Œë¼ìš°ì €ì—ì„œë§Œ)
                this.loadData();

                // 3ë‹¨ê³„: UI ë Œë”ë§
                this.renderCalendar();
                this.bindEvents();

                // 4ë‹¨ê³„: ì²« ë°©ë¬¸ì í™˜ì˜
                this.checkFirstVisit();

                console.log('[App] Initialization complete. Your data is private to this browser.');
            }

            checkFirstVisit() {
                if (this.dataManager.isFirstVisit()) {
                    this.showWelcomeModal();
                }
            }

            showWelcomeModal() {
                document.getElementById('welcome-modal').classList.add('active');
            }

            closeWelcomeModal() {
                document.getElementById('welcome-modal').classList.remove('active');
                this.dataManager.markAsVisited();
            }

            loadData() {
                // DataManagerë¥¼ í†µí•´ ë¡œì»¬ ë°ì´í„°ë§Œ ë¡œë“œ
                // URLì´ë‚˜ ì™¸ë¶€ ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ì•ŠìŒ
                this.data = this.dataManager.loadCalendarData();
            }

            saveData() {
                // DataManagerë¥¼ í†µí•´ ë¡œì»¬ì—ë§Œ ì €ì¥
                // ì„œë²„, URL, ì¿ í‚¤ì—ëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ
                this.dataManager.saveCalendarData(this.data);
            }

            // ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜: meeting -> meetings ë°°ì—´ë¡œ ë³€í™˜
            getMeetingsFromRecord(record) {
                if (!record) return [];

                // ìƒˆ í˜•ì‹: meetings ë°°ì—´
                if (record.meetings && Array.isArray(record.meetings)) {
                    return record.meetings.filter(m => m.time || m.place || m.person);
                }

                // ê¸°ì¡´ í˜•ì‹: ë‹¨ì¼ meeting ê°ì²´ -> ë°°ì—´ë¡œ ë³€í™˜
                if (record.meeting && (record.meeting.time || record.meeting.place || record.meeting.person)) {
                    return [record.meeting];
                }

                return [];
            }

            // ë§Œë‚¨ í•­ëª© HTML ìƒì„±
            createMeetingEntryHTML(index, meeting = {}) {
                return `
                    <div class="meeting-entry" data-meeting-index="${index}">
                        <div class="meeting-entry-header">
                            <span class="meeting-entry-title">ë§Œë‚¨ ${index + 1}</span>
                            <button type="button" class="remove-meeting-btn" data-remove-index="${index}">Ã—</button>
                        </div>
                        <div class="meeting-field">
                            <label>ì‹œê°„</label>
                            <input type="text" class="meeting-time-input" placeholder="ì˜¤í›„, ì €ë…, 14:00 ë“±" value="${meeting.time || ''}" />
                        </div>
                        <div class="meeting-field">
                            <label>ì¥ì†Œ</label>
                            <input type="text" class="meeting-place-input" placeholder="ì—°êµ¬ì‹¤, ì¹´í˜ ë“±" value="${meeting.place || ''}" />
                        </div>
                        <div class="meeting-field">
                            <label>ë§Œë‚œ ì‚¬ëŒ</label>
                            <input type="text" class="meeting-person-input" placeholder="ë™ë£Œ, ì¹œêµ¬ ë“±" value="${meeting.person || ''}" />
                        </div>
                    </div>
                `;
            }

            // ë§Œë‚¨ ëª©ë¡ ë Œë”ë§
            renderMeetings(meetings = []) {
                const container = document.getElementById('meetings-container');

                if (meetings.length === 0) {
                    container.innerHTML = '<div class="no-meetings-message">ë§Œë‚¨ ì¶”ê°€ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê¸°ë¡í•˜ì„¸ìš”</div>';
                } else {
                    container.innerHTML = meetings.map((m, i) => this.createMeetingEntryHTML(i, m)).join('');
                }

                // ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë°”ì¸ë”©
                container.querySelectorAll('.remove-meeting-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.dataset.removeIndex);
                        this.removeMeetingEntry(index);
                    });
                });
            }

            // ìƒˆ ë§Œë‚¨ ì¶”ê°€
            addMeetingEntry() {
                const container = document.getElementById('meetings-container');
                const currentMeetings = this.collectMeetingsFromForm();
                currentMeetings.push({ time: '', place: '', person: '' });
                this.renderMeetings(currentMeetings);

                // ë§Œë‚¨ ì„¹ì…˜ í¼ì¹˜ê¸°
                document.getElementById('meeting-section').open = true;
            }

            // ë§Œë‚¨ ì‚­ì œ
            removeMeetingEntry(index) {
                const currentMeetings = this.collectMeetingsFromForm();
                currentMeetings.splice(index, 1);
                this.renderMeetings(currentMeetings);
            }

            // í¼ì—ì„œ í˜„ì¬ ë§Œë‚¨ ë°ì´í„° ìˆ˜ì§‘
            collectMeetingsFromForm() {
                const entries = document.querySelectorAll('.meeting-entry');
                const meetings = [];

                entries.forEach(entry => {
                    const time = entry.querySelector('.meeting-time-input').value.trim();
                    const place = entry.querySelector('.meeting-place-input').value.trim();
                    const person = entry.querySelector('.meeting-person-input').value.trim();

                    meetings.push({ time, place, person });
                });

                return meetings;
            }

            getDateKey(date) {
                return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            }

            renderCalendar() {
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();

                document.getElementById('current-month').textContent = `${year}ë…„ ${month + 1}ì›”`;

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDay = firstDay.getDay();
                const totalDays = lastDay.getDate();

                const grid = document.getElementById('calendar-grid');
                grid.innerHTML = '';

                // ìš”ì¼ í—¤ë”
                ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '].forEach(day => {
                    const header = document.createElement('div');
                    header.className = 'calendar-day-header';
                    header.textContent = day;
                    grid.appendChild(header);
                });

                // ë¹ˆ ì¹¸
                for (let i = 0; i < startDay; i++) {
                    const empty = document.createElement('div');
                    empty.className = 'calendar-day empty';
                    grid.appendChild(empty);
                }

                // ë‚ ì§œ
                const today = new Date();
                for (let day = 1; day <= totalDays; day++) {
                    const date = new Date(year, month, day);
                    const dateKey = this.getDateKey(date);
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day';

                    if (date.toDateString() === today.toDateString()) {
                        dayEl.classList.add('today');
                    }

                    if (this.data[dateKey]) {
                        dayEl.classList.add('has-data');
                        const indicator = document.createElement('div');
                        indicator.className = 'day-indicator';
                        const energy = this.data[dateKey].energy;
                        indicator.textContent = energy === 'ë†’ìŒ' ? 'ğŸ”¥' : energy === 'ë³´í†µ' ? 'âš¡' : 'ğŸŒ™';
                        dayEl.appendChild(indicator);

                        // ë§Œë‚¨ ì•„ì´ì½˜ í‘œì‹œ (ë³µìˆ˜ ë§Œë‚¨ ì§€ì›)
                        const record = this.data[dateKey];
                        const meetings = this.getMeetingsFromRecord(record);
                        if (meetings.length > 0) {
                            const meetingIcon = document.createElement('span');
                            meetingIcon.className = 'meeting-indicator';
                            if (meetings.length === 1) {
                                meetingIcon.textContent = 'ğŸ‘¤';
                            } else {
                                meetingIcon.innerHTML = 'ğŸ‘¤<span class="meeting-count">' + meetings.length + '</span>';
                            }
                            dayEl.appendChild(meetingIcon);
                        }
                    }

                    const number = document.createElement('div');
                    number.className = 'day-number';
                    number.textContent = day;
                    dayEl.appendChild(number);

                    dayEl.addEventListener('click', () => this.openModal(date));
                    grid.appendChild(dayEl);
                }
            }

            openModal(date) {
                this.selectedDate = date;
                const dateKey = this.getDateKey(date);
                const record = this.data[dateKey];

                document.getElementById('modal-title').textContent =
                    `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;

                // í¼ ì´ˆê¸°í™”
                document.querySelectorAll('.energy-btn').forEach(btn => btn.classList.remove('selected'));
                document.getElementById('tags-input').value = '';
                document.getElementById('memo-input').value = '';

                // ë§Œë‚¨ í•„ë“œ ì´ˆê¸°í™”
                this.renderMeetings([]);
                document.getElementById('meeting-section').open = false;

                // ì €ì¥ëœ ìš”ì•½ ì´ˆê¸°í™”
                const savedSummaryContainer = document.getElementById('saved-summary-container');
                savedSummaryContainer.style.display = 'none';

                // ê¸°ì¡´ ë°ì´í„° ë¡œë“œ
                if (record) {
                    const energyBtn = document.querySelector(`[data-energy="${record.energy}"]`);
                    if (energyBtn) energyBtn.classList.add('selected');
                    document.getElementById('tags-input').value = record.tags.join(' ');
                    document.getElementById('memo-input').value = record.memo || '';
                    document.getElementById('delete-btn').style.display = 'block';

                    // ì €ì¥ëœ ìš”ì•½ í‘œì‹œ
                    if (record.summary) {
                        document.getElementById('saved-summary-text').textContent = record.summary;
                        savedSummaryContainer.style.display = 'block';
                    }

                    // ë§Œë‚¨ ë°ì´í„° ë¡œë“œ (ë³µìˆ˜ ë§Œë‚¨ ì§€ì›)
                    const meetings = this.getMeetingsFromRecord(record);
                    this.renderMeetings(meetings);

                    // ë§Œë‚¨ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì„¹ì…˜ í¼ì¹˜ê¸°
                    if (meetings.length > 0) {
                        document.getElementById('meeting-section').open = true;
                    }
                } else {
                    document.getElementById('delete-btn').style.display = 'none';
                }

                document.getElementById('modal').classList.add('active');
            }

            closeModal() {
                document.getElementById('modal').classList.remove('active');
            }

            saveRecord(e) {
                e.preventDefault();

                const selectedEnergy = document.querySelector('.energy-btn.selected');
                if (!selectedEnergy) {
                    alert('í•˜ë£¨ì˜ ë°€ë„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”');
                    return;
                }

                const energy = selectedEnergy.dataset.energy;
                const tagsInput = document.getElementById('tags-input').value;
                const tags = tagsInput.split(/\s+/).filter(t => t.startsWith('#')).slice(0, 2);
                const memo = document.getElementById('memo-input').value.trim();

                // ë§Œë‚¨ ë°ì´í„° ìˆ˜ì§‘ (ë³µìˆ˜ ë§Œë‚¨)
                const allMeetings = this.collectMeetingsFromForm();
                // ë¹ˆ ë§Œë‚¨ í•­ëª© ì œê±° (ìµœì†Œ í•˜ë‚˜ì˜ í•„ë“œë¼ë„ ì…ë ¥ëœ ê²ƒë§Œ ì €ì¥)
                const meetings = allMeetings.filter(m => m.time || m.place || m.person);

                if (tags.length === 0) {
                    alert('íƒœê·¸ë¥¼ 1ê°œ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš” (#ìœ¼ë¡œ ì‹œì‘)');
                    return;
                }

                const dateKey = this.getDateKey(this.selectedDate);
                const existingRecord = this.data[dateKey];

                // ìš”ì•½ ë¬¸ì¥ ìƒì„±
                const summary = this.generateDailySummary(energy, tags, memo);

                // ë°ì´í„° ì €ì¥ (ìš”ì•½ ë° ë³µìˆ˜ ë§Œë‚¨ í¬í•¨)
                this.data[dateKey] = { energy, tags, memo, summary, meetings };
                this.saveData();

                // ëª¨ë‹¬ ë‹«ê¸° (ì €ì¥ ì§í›„ì—ëŠ” ë¬¸ì¥ì„ ë³´ì—¬ì£¼ì§€ ì•ŠìŒ)
                this.closeModal();
                this.renderCalendar();
            }

            deleteRecord() {
                if (confirm('ì´ ë‚ ì˜ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    const dateKey = this.getDateKey(this.selectedDate);
                    delete this.data[dateKey];
                    this.saveData();
                    this.closeModal();
                    this.renderCalendar();
                }
            }

            updateSummaryInModal(summary) {
                const savedSummaryContainer = document.getElementById('saved-summary-container');
                const savedSummaryText = document.getElementById('saved-summary-text');

                if (summary) {
                    savedSummaryText.textContent = summary;
                    savedSummaryContainer.style.display = 'block';
                } else {
                    savedSummaryContainer.style.display = 'none';
                }
            }

            generateDailySummary(energy, tags, memo) {
                console.log('ğŸ”„ ìš”ì•½ ìƒì„± ì‹œì‘ - ì—ë„ˆì§€:', energy, 'íƒœê·¸:', tags, 'ë©”ëª¨:', memo);

                const recentContext = this.analyzeRecentDays(7);
                const cleanTags = tags.map(tag => tag.replace('#', ''));
                const context = {
                    today: { energy: energy, tags: cleanTags, memo: memo },
                    recent: recentContext,
                    selectedDate: this.selectedDate
                };
                const summary = this.generateWarmSentence(context);

                console.log('âœ… ìš”ì•½ ìƒì„± ì™„ë£Œ:', summary);
                return summary;
            }

            analyzeRecentDays(days) {
                const today = this.selectedDate;
                const recentRecords = [];
                const energyTrend = [];
                const tagFrequency = {};

                for (let i = 1; i <= days; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = this.getDateKey(date);
                    if (this.data[dateKey]) {
                        const record = this.data[dateKey];
                        recentRecords.push(record);
                        energyTrend.push(record.energy);
                        record.tags.forEach(tag => {
                            const cleanTag = tag.replace('#', '');
                            tagFrequency[cleanTag] = (tagFrequency[cleanTag] || 0) + 1;
                        });
                    }
                }

                const lowCount = energyTrend.filter(e => e === 'ë‚®ìŒ').length;
                const highCount = energyTrend.filter(e => e === 'ë†’ìŒ').length;
                const totalCount = energyTrend.length;
                let energyPattern = 'neutral';
                if (totalCount >= 2) {
                    if (lowCount / totalCount > 0.6) energyPattern = 'mostly_low';
                    else if (highCount / totalCount > 0.6) energyPattern = 'mostly_high';
                    else if (lowCount >= 2) energyPattern = 'some_low';
                }

                const frequentTags = Object.entries(tagFrequency)
                    .filter(([tag, count]) => count >= 2)
                    .sort((a, b) => b[1] - a[1])
                    .map(([tag]) => tag);

                return {
                    hasRecentData: recentRecords.length > 0,
                    recordCount: recentRecords.length,
                    energyPattern: energyPattern,
                    frequentTags: frequentTags.slice(0, 3),
                    lastEnergy: energyTrend[0] || null
                };
            }

            generateWarmSentence(context) {
                const { today, recent } = context;
                const { energy, tags, memo } = today;
                const sentiment = this.analyzeSentiment(memo);
                const seed = this.selectedDate.getDate() + this.selectedDate.getMonth() * 31;

                if (recent.hasRecentData && recent.recordCount >= 2) {
                    return this.generateContextualSentence(today, recent, sentiment, seed);
                } else {
                    return this.generateStandaloneSentence(today, sentiment, seed);
                }
            }

            analyzeSentiment(memo) {
                if (!memo) return 'neutral';
                const positiveWords = ['ì¢‹', 'í–‰ë³µ', 'ê¸°ì¨', 'ì¦ê±°', 'ë§Œì¡±', 'ì„±ê³µ', 'ì˜'];
                const negativeWords = ['í˜ë“¤', 'í”¼ê³¤', 'ì§€ì¹¨', 'ì–´ë ¤', 'ì•„ì‰¬', 'ì‹¤ë§', 'ë¶ˆì•ˆ', 'ë²„ê±°'];
                const neutralWords = ['ìƒê°', 'ê³ ë¯¼', 'ì •ë¦¬', 'ê³„íš', 'ì¤€ë¹„'];
                const memoLower = memo.toLowerCase();
                const hasPositive = positiveWords.some(word => memoLower.includes(word));
                const hasNegative = negativeWords.some(word => memoLower.includes(word));
                const hasNeutral = neutralWords.some(word => memoLower.includes(word));
                if (hasNegative) return 'difficult';
                if (hasPositive) return 'positive';
                if (hasNeutral) return 'thoughtful';
                return 'neutral';
            }

            generateContextualSentence(today, recent, sentiment, seed) {
                const { energy, tags } = today;
                const patterns = [];

                if (recent.energyPattern === 'mostly_low' && energy === 'ë‚®ìŒ') {
                    patterns.push(
                        'ìš”ì¦˜ ê³„ì† í˜ë“  ì‹œê°„ì´ì—ˆë˜ ê±¸ ìƒê°í•˜ë©´, ì˜¤ëŠ˜ë„ ì‰½ì§€ ì•Šì•˜ì„ ê²ƒ ê°™ì•„. ê·¸ë˜ë„ ì—¬ê¸°ê¹Œì§€ ì˜¨ ê±¸ë¡œ ì¶©ë¶„í•´.',
                        'ìµœê·¼ ë©°ì¹ ì„ ë³´ë©´, ì˜¤ëŠ˜ë„ ë²„í‹°ëŠ” ê²ƒ ìì²´ê°€ ì• ì“´ ê±°ì•¼.',
                        'ìš”ì¦˜ íë¦„ ì†ì—ì„œ ì˜¤ëŠ˜ë„ í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í–ˆë‹¤ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ê´œì°®ì•„.'
                    );
                } else if (recent.energyPattern === 'mostly_low' && energy !== 'ë‚®ìŒ') {
                    patterns.push(
                        'ìš”ì¦˜ í˜ë“¤ì—ˆë˜ ê²ƒ ê°™ì€ë°, ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ë‚˜ì•„ì§„ ê²ƒ ê°™ì•„ ë‹¤í–‰ì´ì•¼.',
                        'ìµœê·¼ ë©°ì¹ ì„ ìƒê°í•˜ë©´, ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ìˆ¨í†µì´ íŠ¸ì¸ ëŠë‚Œì´ì•¼.',
                        'ìš”ì¦˜ ê³„ì† ë²„ê±°ì› ëŠ”ë°, ì˜¤ëŠ˜ì€ ê·¸ë˜ë„ ê´œì°®ì€ í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„.'
                    );
                } else if (recent.energyPattern === 'mostly_high' && energy === 'ë†’ìŒ') {
                    patterns.push(
                        'ìš”ì¦˜ ê³„ì† ë°”ì˜ê²Œ ë‹¬ë ¤ì˜¨ ê²ƒ ê°™ì•„. ì˜¤ëŠ˜ë„ ì—´ì‹¬íˆ ë³´ëƒˆêµ¬ë‚˜.',
                        'ìµœê·¼ íë¦„ì„ ë³´ë©´, ì˜¤ëŠ˜ë„ ì§‘ì¤‘í•´ì„œ í•˜ë£¨ë¥¼ ì±„ìš´ ê²ƒ ê°™ì•„.',
                        'ìš”ì¦˜ ê³„ì† ì›€ì§ì´ê³  ìˆì—ˆëŠ”ë°, ì˜¤ëŠ˜ë„ ê·¸ íë¦„ì´ ì´ì–´ì§„ í•˜ë£¨ì•¼.'
                    );
                } else if (recent.energyPattern === 'mostly_high' && energy === 'ë‚®ìŒ') {
                    patterns.push(
                        'ìš”ì¦˜ ê³„ì† ë°”ë¹´ë˜ ê±¸ ìƒê°í•˜ë©´, ì˜¤ëŠ˜ì€ ì¢€ ì‰¬ê³  ì‹¶ì—ˆì„ ê²ƒ ê°™ì•„.',
                        'ìµœê·¼ ê³„ì† ë‹¬ë ¤ì™”ìœ¼ë‹ˆ, ì˜¤ëŠ˜ì€ í”¼ê³¤í–ˆì„ ë§Œë„ í•´.',
                        'ìš”ì¦˜ íë¦„ì„ ë³´ë©´, ì˜¤ëŠ˜ì€ í•œìˆ¨ ëŒë¦¬ëŠ” ì‹œê°„ì´ í•„ìš”í–ˆë˜ ê²ƒ ê°™ì•„.'
                    );
                } else if (recent.frequentTags.length > 0) {
                    const repeatedTag = recent.frequentTags[0];
                    const todayHasTag = tags.some(t => t === repeatedTag);
                    if (todayHasTag) {
                        patterns.push(
                            `ìš”ì¦˜ ê³„ì† ${repeatedTag} ì¤‘ì‹¬ìœ¼ë¡œ í•˜ë£¨ë¥¼ ë³´ë‚´ê³  ìˆëŠ” ê²ƒ ê°™ì•„. ì˜¤ëŠ˜ë„ ê·¸ëŸ° í•˜ë£¨ì˜€êµ¬ë‚˜.`,
                            `ìµœê·¼ ë©°ì¹ ì„ ë³´ë©´, ${repeatedTag}ì´ ê³„ì† ë„ˆì˜ ì£¼ìš” ê´€ì‹¬ì‚¬ì˜€ë˜ ê²ƒ ê°™ì•„.`,
                            `ìš”ì¦˜ ${repeatedTag}ì— ì§‘ì¤‘í•˜ê³  ìˆëŠ” ê²ƒ ê°™ì•„. ì˜¤ëŠ˜ë„ ê·¸ íë¦„ ì†ì— ìˆì—ˆêµ¬ë‚˜.`
                        );
                    } else {
                        patterns.push(
                            `ìš”ì¦˜ì€ ì£¼ë¡œ ${repeatedTag}ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë³´ëƒˆëŠ”ë°, ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ë‹¤ë¥¸ í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„.`,
                            `ìµœê·¼ íë¦„ê³¼ëŠ” ì¡°ê¸ˆ ë‹¤ë¥´ê²Œ, ì˜¤ëŠ˜ì€ ë‚˜ë¦„ì˜ í•˜ë£¨ë¥¼ ë³´ë‚¸ ê²ƒ ê°™ì•„.`
                        );
                    }
                } else {
                    if (sentiment === 'difficult') {
                        patterns.push(
                            'ìš”ì¦˜ íë¦„ ì†ì—ì„œ ì˜¤ëŠ˜ë„ ì‰½ì§€ ì•Šì€ í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„. ê·¸ë˜ë„ ì—¬ê¸°ê¹Œì§€ ì™”ì–´.',
                            'ìµœê·¼ ë©°ì¹ ì„ ë³´ë©´, ì˜¤ëŠ˜ë„ ë„ˆ ë‚˜ë¦„ëŒ€ë¡œ í•˜ë£¨ë¥¼ ë²„í…¨ë‚¸ ê²ƒ ê°™ì•„.',
                            'ìš”ì¦˜ë„ ê·¸ë ‡ê³  ì˜¤ëŠ˜ë„ ê·¸ë ‡ê³ , ì¡°ìš©íˆ ì• ì“°ê³  ìˆëŠ” ê²ƒ ê°™ì•„.'
                        );
                    } else if (sentiment === 'positive') {
                        patterns.push(
                            'ìµœê·¼ ë©°ì¹ ì„ ë³´ë©´, ì˜¤ëŠ˜ë„ ê´œì°®ì€ í•˜ë£¨ë¥¼ ë³´ë‚¸ ê²ƒ ê°™ì•„.',
                            'ìš”ì¦˜ íë¦„ ì†ì—ì„œ ì˜¤ëŠ˜ë„ ë‚˜ë¦„ëŒ€ë¡œ ì˜ë¯¸ ìˆëŠ” ì‹œê°„ì´ì—ˆë˜ ê²ƒ ê°™ì•„.',
                            'í° ë§ì€ ì—†ì—ˆì§€ë§Œ, ìš”ì¦˜ë„ ì˜¤ëŠ˜ë„ ì˜ ì§€ë‚´ê³  ìˆëŠ” ê²ƒ ê°™ì•„.'
                        );
                    } else {
                        patterns.push(
                            'í° ë§ì€ ì—†ì—ˆì§€ë§Œ, ìš”ì¦˜ íë¦„ ì†ì—ì„œ ì˜¤ëŠ˜ë„ ì¡°ìš©íˆ ì• ì“´ í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„.',
                            'ìµœê·¼ ë©°ì¹ ì„ ë³´ë©´, ì˜¤ëŠ˜ë„ ë„ˆ ë‚˜ë¦„ëŒ€ë¡œ í•˜ë£¨ë¥¼ ì±„ìš´ ê²ƒ ê°™ì•„.',
                            'ìš”ì¦˜ë„ ê·¸ë ‡ê³  ì˜¤ëŠ˜ë„ ê·¸ë ‡ê³ , ê·¸ëƒ¥ í•˜ë£¨í•˜ë£¨ ì§€ë‚˜ê°€ê³  ìˆêµ¬ë‚˜.',
                            'ìµœê·¼ íë¦„ ì†ì—ì„œ ì˜¤ëŠ˜ë„ ì¡°ìš©íˆ í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í–ˆì–´.'
                        );
                    }
                }

                if (patterns.length === 0) {
                    patterns.push(
                        'ìµœê·¼ ë©°ì¹ ì„ ë³´ë©´, ì˜¤ëŠ˜ë„ ë„ˆ ë‚˜ë¦„ëŒ€ë¡œ í•˜ë£¨ë¥¼ ë³´ë‚¸ ê²ƒ ê°™ì•„.',
                        'ìš”ì¦˜ íë¦„ ì†ì—ì„œ ì˜¤ëŠ˜ë„ í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í–ˆêµ¬ë‚˜.'
                    );
                }

                return patterns[seed % patterns.length];
            }

            generateStandaloneSentence(today, sentiment, seed) {
                const { energy, tags } = today;
                const patterns = [];

                if (energy === 'ë‚®ìŒ') {
                    if (sentiment === 'difficult') {
                        patterns.push(
                            'ì˜¤ëŠ˜ì€ ì‰½ì§€ ì•Šì€ í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„. ê·¸ë˜ë„ ì—¬ê¸°ê¹Œì§€ ì˜¨ ê±¸ë¡œ ì¶©ë¶„í•´.',
                            'í˜ë“  í•˜ë£¨ë¥¼ ë³´ëƒˆêµ¬ë‚˜. ê·¸ê²ƒë§Œìœ¼ë¡œë„ ì˜í•œ ê±°ì•¼.',
                            'ë²„ê±°ìš´ í•˜ë£¨ì˜€ì„ ê²ƒ ê°™ì•„. ê³ ìƒí–ˆì–´.'
                        );
                    } else {
                        patterns.push(
                            'ì˜¤ëŠ˜ì€ ì¡°ìš©íˆ ì‰¬ì–´ê°€ëŠ” í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„.',
                            'ì˜¤ëŠ˜ì€ ì—ë„ˆì§€ë¥¼ ì•„ë¼ë©° ë³´ë‚¸ í•˜ë£¨ì˜€êµ¬ë‚˜.',
                            'í”¼ê³¤í•œ í•˜ë£¨ì˜€ì„ ê²ƒ ê°™ì•„. ê´œì°®ì•„.'
                        );
                    }
                } else if (energy === 'ë†’ìŒ') {
                    patterns.push(
                        'ì˜¤ëŠ˜ì€ ì§‘ì¤‘í•´ì„œ í•˜ë£¨ë¥¼ ë³´ë‚¸ ê²ƒ ê°™ì•„.',
                        'í™œê¸°ì°¨ê²Œ í•˜ë£¨ë¥¼ ì±„ìš´ ê²ƒ ê°™ì•„.',
                        'ì˜¤ëŠ˜ì€ ì—´ì‹¬íˆ ì›€ì§ì¸ í•˜ë£¨ì˜€êµ¬ë‚˜.'
                    );
                } else {
                    if (sentiment === 'difficult') {
                        patterns.push(
                            'ì˜¤ëŠ˜ì€ ë‚˜ë¦„ëŒ€ë¡œ ë²„í…¨ë‚¸ í•˜ë£¨ì˜€ë˜ ê²ƒ ê°™ì•„.',
                            'ì‰½ì§€ë§Œì€ ì•Šì•˜ì§€ë§Œ, í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í–ˆêµ¬ë‚˜.'
                        );
                    } else {
                        patterns.push(
                            'ì˜¤ëŠ˜ë„ ê·¸ëƒ¥ í•˜ë£¨ê°€ ì§€ë‚˜ê°”êµ¬ë‚˜.',
                            'ì˜¤ëŠ˜ì€ ê·¸ë ‡ê²Œ í•˜ë£¨ë¥¼ ë³´ëƒˆì–´.',
                            'í‰ë²”í•˜ê²Œ í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í–ˆêµ¬ë‚˜.'
                        );
                    }
                }

                return patterns[seed % patterns.length];
            }

            showSummaryModal(summary) {
                console.log('ğŸ“ ìš”ì•½ ëª¨ë‹¬ í‘œì‹œ:', summary);
                const summaryModal = document.getElementById('summary-modal');
                const summaryText = document.getElementById('summary-text');

                if (!summaryModal || !summaryText) {
                    console.error('ìš”ì•½ ëª¨ë‹¬ DOM ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                summaryText.textContent = summary;
                summaryModal.classList.add('active');
                console.log('âœ… ìš”ì•½ ëª¨ë‹¬ í™œì„±í™” ì™„ë£Œ');
            }

            closeSummaryModal() {
                document.getElementById('summary-modal').classList.remove('active');
            }

            async copySentenceToClipboard() {
                const sentenceText = document.getElementById('saved-summary-text').textContent;

                if (!sentenceText) {
                    alert('ë³µì‚¬í•  ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                try {
                    await navigator.clipboard.writeText(sentenceText);
                    alert('ë¬¸ì¥ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } catch (err) {
                    console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                    // í´ë°±: textarea ë°©ì‹
                    const textArea = document.createElement('textarea');
                    textArea.value = sentenceText;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-999999px';
                    document.body.appendChild(textArea);
                    textArea.select();

                    try {
                        document.execCommand('copy');
                        alert('ë¬¸ì¥ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } catch (fallbackErr) {
                        console.error('í´ë°± ë³µì‚¬ë„ ì‹¤íŒ¨:', fallbackErr);
                        alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }

                    document.body.removeChild(textArea);
                }
            }

            shareSentence() {
                const sentenceText = document.getElementById('saved-summary-text').textContent;

                if (!sentenceText) {
                    alert('ê³µìœ í•  ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                // ì´ë¯¸ì§€ ìƒì„± ë° ê³µìœ 
                this.generateShareImageFromText(sentenceText);
            }

            generateShareImageFromText(summaryText) {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const width = 800;
                const height = 600;
                canvas.width = width;
                canvas.height = height;

                // ë°°ê²½
                const gradient = ctx.createLinearGradient(0, 0, 0, height);
                gradient.addColorStop(0, '#e8f5e9');
                gradient.addColorStop(1, '#c8e6c9');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);

                // í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
                ctx.fillStyle = '#2e7d32';
                ctx.font = 'bold 28px "Segoe UI", sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // ë¬¸ì¥ ì¤„ë°”ê¿ˆ
                const lines = this.wrapKoreanText(ctx, summaryText, width - 100);
                const lineHeight = 45;
                const startY = (height - (lines.length * lineHeight)) / 2;

                lines.forEach((line, i) => {
                    ctx.fillText(line, width / 2, startY + (i * lineHeight));
                });

                // ì„œë¹„ìŠ¤ëª…
                ctx.fillStyle = '#66bb6a';
                ctx.font = '20px "Segoe UI", sans-serif';
                ctx.fillText('ìš”ì¦˜ ì–´ë•Œ?', width / 2, height - 50);

                // ì´ë¯¸ì§€ ê³µìœ /ë‹¤ìš´ë¡œë“œ
                this.shareOrDownloadImage(canvas);
            }

            async copySummaryToClipboard() {
                const summaryText = document.getElementById('summary-text').textContent;

                try {
                    await navigator.clipboard.writeText(summaryText);
                    alert('ë¬¸ì¥ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } catch (err) {
                    // í´ë°±: textarea ì‚¬ìš©
                    const textarea = document.createElement('textarea');
                    textarea.value = summaryText;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('ë¬¸ì¥ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            }

            generateShareImage() {
                const canvas = document.getElementById('share-canvas');
                const ctx = canvas.getContext('2d');
                const summaryText = document.getElementById('summary-text').textContent;

                // ë°°ê²½
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, 800, 600);

                // ë©”ì¸ í…ìŠ¤íŠ¸ ì˜ì—­
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(40, 150, 720, 280);

                // ìš”ì•½ ë¬¸ì¥
                ctx.fillStyle = '#333333';
                ctx.font = '28px "Segoe UI", sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // ê¸´ ë¬¸ì¥ ì¤„ë°”ê¿ˆ ì²˜ë¦¬
                const maxWidth = 680;
                const words = summaryText.split(' ');
                let line = '';
                let y = 290;
                const lineHeight = 40;

                for (let word of words) {
                    const testLine = line + word;
                    const metrics = ctx.measureText(testLine);

                    if (metrics.width > maxWidth && line !== '') {
                        ctx.fillText(line, 400, y);
                        line = word + ' ';
                        y += lineHeight;
                    } else {
                        line = testLine + ' ';
                    }
                }
                ctx.fillText(line, 400, y);

                // í•˜ë‹¨ ì„œë¹„ìŠ¤ëª…
                ctx.fillStyle = '#999999';
                ctx.font = '18px "Segoe UI", sans-serif';
                ctx.fillText('ìš”ì¦˜ ì–´ë•Œ?', 400, 520);

                // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë˜ëŠ” ê³µìœ 
                canvas.toBlob((blob) => {
                    const file = new File([blob], 'daily-summary.png', { type: 'image/png' });

                    // Web Share API ì§€ì› í™•ì¸
                    if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                        navigator.share({
                            files: [file],
                            title: 'ì˜¤ëŠ˜ì˜ í•œ ë¬¸ì¥',
                            text: summaryText
                        }).catch(err => {
                            // ê³µìœ  ì·¨ì†Œ ì‹œ ë‹¤ìš´ë¡œë“œ
                            this.downloadImage(canvas);
                        });
                    } else {
                        // Web Share API ë¯¸ì§€ì› ì‹œ ë‹¤ìš´ë¡œë“œ
                        this.downloadImage(canvas);
                    }
                });
            }

            downloadImage(canvas) {
                const link = document.createElement('a');
                link.download = 'daily-summary.png';
                link.href = canvas.toDataURL();
                link.click();
                alert('ì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            /**
             * í•œê¸€ í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ì²˜ë¦¬
             * Canvasì—ì„œ í…ìŠ¤íŠ¸ë¥¼ maxWidthì— ë§ê²Œ ì—¬ëŸ¬ ì¤„ë¡œ ë‚˜ëˆ”
             */
            wrapKoreanText(ctx, text, maxWidth) {
                const lines = [];
                let currentLine = '';

                for (let i = 0; i < text.length; i++) {
                    const char = text[i];
                    const testLine = currentLine + char;
                    const metrics = ctx.measureText(testLine);

                    if (metrics.width > maxWidth && currentLine !== '') {
                        lines.push(currentLine);
                        currentLine = char;
                    } else {
                        currentLine = testLine;
                    }
                }

                if (currentLine) {
                    lines.push(currentLine);
                }

                return lines;
            }

            /**
             * ì´ë¯¸ì§€ ê³µìœ  ë˜ëŠ” ë‹¤ìš´ë¡œë“œ
             * Web Share API ì§€ì› ì‹œ ê³µìœ , ë¯¸ì§€ì› ì‹œ ë‹¤ìš´ë¡œë“œ
             */
            shareOrDownloadImage(canvas) {
                canvas.toBlob((blob) => {
                    if (!blob) {
                        alert('ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        return;
                    }

                    const file = new File([blob], 'daily-summary.png', { type: 'image/png' });

                    // Web Share API ì§€ì› í™•ì¸
                    if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                        navigator.share({
                            files: [file],
                            title: 'ì˜¤ëŠ˜ì˜ í•œ ë¬¸ì¥',
                            text: 'ìš”ì¦˜ ì–´ë•Œ?'
                        }).catch(err => {
                            // ê³µìœ  ì·¨ì†Œ ì‹œ ë‹¤ìš´ë¡œë“œ
                            console.log('ê³µìœ  ì·¨ì†Œë¨, ë‹¤ìš´ë¡œë“œë¡œ ì „í™˜');
                            this.downloadImage(canvas);
                        });
                    } else {
                        // Web Share API ë¯¸ì§€ì› ì‹œ ë‹¤ìš´ë¡œë“œ
                        this.downloadImage(canvas);
                    }
                }, 'image/png');
            }

            renderStats() {
                const days = this.statsPeriod;
                const today = new Date();
                const records = [];

                for (let i = 0; i < days; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = this.getDateKey(date);
                    if (this.data[dateKey]) {
                        records.push(this.data[dateKey]);
                    }
                }

                const statsContent = document.getElementById('stats-content');

                if (records.length === 0) {
                    statsContent.innerHTML = '<p style="text-align:center;color:#999;padding:40px;">ì•„ì§ ê¸°ë¡ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }

                // ì—ë„ˆì§€ ë¶„í¬ ê³„ì‚°
                const energyCount = { 'ë†’ìŒ': 0, 'ë³´í†µ': 0, 'ë‚®ìŒ': 0 };
                const tagCount = {};

                records.forEach(record => {
                    energyCount[record.energy]++;
                    record.tags.forEach(tag => {
                        tagCount[tag] = (tagCount[tag] || 0) + 1;
                    });
                });

                const totalRecords = records.length;
                const topTags = Object.entries(tagCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5);

                // í•´ì„ ìƒì„±
                const insights = this.generateInsights(energyCount, topTags, totalRecords, days);

                // HTML ìƒì„±
                let html = '<div class="stats-section">';
                html += '<h3>ğŸ“Š ê¸°ê°„ ìš”ì•½</h3>';
                insights.forEach(insight => {
                    html += `<div class="insight">${insight}</div>`;
                });
                html += '</div>';

                // ì—ë„ˆì§€ ì°¨íŠ¸
                html += '<div class="stats-section">';
                html += '<h3>âš¡ í•˜ë£¨ì˜ ë°€ë„ ë¶„í¬</h3>';
                html += '<div class="energy-chart">';

                const maxCount = Math.max(...Object.values(energyCount));
                ['ë†’ìŒ', 'ë³´í†µ', 'ë‚®ìŒ'].forEach(energy => {
                    const count = energyCount[energy];
                    const percentage = maxCount > 0 ? (count / maxCount * 100) : 0;
                    const type = energy === 'ë†’ìŒ' ? 'high' : energy === 'ë³´í†µ' ? 'medium' : 'low';
                    const emoji = energy === 'ë†’ìŒ' ? 'ğŸ”¥' : energy === 'ë³´í†µ' ? 'âš¡' : 'ğŸŒ™';

                    html += `
                        <div class="energy-bar">
                            <div class="bar">
                                <div class="bar-fill ${type}" style="height: ${percentage}%"></div>
                                <div class="bar-value">${count}ì¼</div>
                            </div>
                            <div class="bar-label">${emoji} ${energy}</div>
                        </div>
                    `;
                });
                html += '</div></div>';

                // íƒœê·¸ ìˆœìœ„
                if (topTags.length > 0) {
                    html += '<div class="stats-section">';
                    html += '<h3>ğŸ·ï¸ ìì£¼ ë“±ì¥í•œ íƒœê·¸</h3>';
                    html += '<div class="tag-list">';
                    topTags.forEach(([tag, count]) => {
                        html += `<div class="tag-item">${tag} <span class="tag-count">${count}</span></div>`;
                    });
                    html += '</div></div>';
                }

                statsContent.innerHTML = html;
            }

            generateInsights(energyCount, topTags, totalRecords, days) {
                const insights = [];

                // ì—ë„ˆì§€ í•´ì„
                const highRatio = energyCount['ë†’ìŒ'] / totalRecords;
                const lowRatio = energyCount['ë‚®ìŒ'] / totalRecords;

                insights.push(`ìµœê·¼ ${days}ì¼ ì¤‘ ${totalRecords}ì¼ì˜ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤.`);

                if (lowRatio > 0.5) {
                    insights.push('ìµœê·¼ ì—ë„ˆì§€ê°€ ë‚®ì€ ë‚ ì´ ì ˆë°˜ ì´ìƒì„ ì°¨ì§€í–ˆìŠµë‹ˆë‹¤. ì¶©ë¶„í•œ íœ´ì‹ì´ í•„ìš”í•´ ë³´ì…ë‹ˆë‹¤.');
                } else if (highRatio > 0.5) {
                    insights.push('ìµœê·¼ ì—ë„ˆì§€ê°€ ë†’ì€ ë‚ ì´ ë§ì•˜ìŠµë‹ˆë‹¤. ì¢‹ì€ ì»¨ë””ì…˜ì„ ìœ ì§€í•˜ê³  ê³„ì‹œë„¤ìš”!');
                } else if (energyCount['ë³´í†µ'] > energyCount['ë†’ìŒ'] && energyCount['ë³´í†µ'] > energyCount['ë‚®ìŒ']) {
                    insights.push('ìµœê·¼ í•˜ë£¨ì˜ ë°€ë„ê°€ ì•ˆì •ì ìœ¼ë¡œ ìœ ì§€ë˜ê³  ìˆìŠµë‹ˆë‹¤.');
                }

                // íƒœê·¸ í•´ì„
                if (topTags.length > 0) {
                    const [topTag, topCount] = topTags[0];
                    insights.push(`ê°€ì¥ ìì£¼ ë“±ì¥í•œ íƒœê·¸ëŠ” ${topTag} ì…ë‹ˆë‹¤. (${topCount}íšŒ)`);

                    if (topTags.length > 1) {
                        const secondTag = topTags[1][0];
                        insights.push(`${topTag}ì™€ ${secondTag} íŒ¨í„´ì´ ë‘ë“œëŸ¬ì§‘ë‹ˆë‹¤.`);
                    }
                }

                return insights;
            }

            bindEvents() {
                // íƒ­ ì „í™˜
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));

                        tab.classList.add('active');
                        const view = tab.dataset.view;
                        document.getElementById(`${view}-view`).classList.add('active');

                        if (view === 'stats') {
                            this.renderStats();
                        }
                    });
                });

                // ì›” ì´ë™
                document.getElementById('prev-month').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.renderCalendar();
                });

                document.getElementById('next-month').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.renderCalendar();
                });

                // ëª¨ë‹¬
                document.getElementById('close-modal').addEventListener('click', () => this.closeModal());
                document.getElementById('modal').addEventListener('click', (e) => {
                    if (e.target.id === 'modal') this.closeModal();
                });

                // ì—ë„ˆì§€ ì„ íƒ
                document.querySelectorAll('.energy-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.energy-btn').forEach(b => b.classList.remove('selected'));
                        btn.classList.add('selected');
                    });
                });

                // í¼ ì œì¶œ
                document.getElementById('record-form').addEventListener('submit', (e) => this.saveRecord(e));
                document.getElementById('delete-btn').addEventListener('click', () => this.deleteRecord());

                // ë§Œë‚¨ ì¶”ê°€ ë²„íŠ¼
                document.getElementById('add-meeting-btn').addEventListener('click', () => this.addMeetingEntry());

                // í†µê³„ ê¸°ê°„ ì„ íƒ
                document.querySelectorAll('.period-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.statsPeriod = parseInt(btn.dataset.period);
                        this.renderStats();
                    });
                });

                // ìš”ì•½ ëª¨ë‹¬ ì´ë²¤íŠ¸
                document.getElementById('close-summary-modal').addEventListener('click', () => this.closeSummaryModal());
                document.getElementById('summary-modal').addEventListener('click', (e) => {
                    if (e.target.id === 'summary-modal') this.closeSummaryModal();
                });

                // ë³µì‚¬ ë²„íŠ¼
                document.getElementById('copy-summary-btn').addEventListener('click', () => this.copySummaryToClipboard());

                // ê³µìœ  ë²„íŠ¼
                document.getElementById('share-summary-btn').addEventListener('click', () => this.generateShareImage());

                // ëª¨ë‹¬ ë‚´ ë³µì‚¬/ê³µìœ  ë²„íŠ¼
                document.getElementById('copy-sentence-btn').addEventListener('click', () => this.copySentenceToClipboard());
                document.getElementById('share-sentence-btn').addEventListener('click', () => this.shareSentence());

                // í™˜ì˜ ëª¨ë‹¬ ì‹œì‘ ë²„íŠ¼
                document.getElementById('welcome-start-btn').addEventListener('click', () => this.closeWelcomeModal());
            }
        }

        // ì•± ì‹œì‘
        window.addEventListener('DOMContentLoaded', () => {
            new DailyStatsApp();
        });
    </script>
</body>
</html>
